(this["webpackJsonpsecretin-app"]=this["webpackJsonpsecretin-app"]||[]).push([[0],{484:function(e,t,n){},485:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"MetadataSlice",(function(){return Mt})),n.d(r,"loadMetadataSuccess",(function(){return Dt})),n.d(r,"deleteSecretSuccess",(function(){return Et})),n.d(r,"deleteSecretFailure",(function(){return zt})),n.d(r,"addSecretToFolderSuccess",(function(){return Bt})),n.d(r,"removeSecretFromCurrentFolderSuccess",(function(){return _t})),n.d(r,"createSecretUserRightsSuccess",(function(){return Gt})),n.d(r,"updateSecretSuccess",(function(){return Ht})),n.d(r,"renameSecretSuccess",(function(){return Yt})),n.d(r,"updateSecretUserRightsSuccess",(function(){return Vt})),n.d(r,"deleteSecretUserRightsSuccess",(function(){return Wt})),n.d(r,"loadMetadata",(function(){return Qt})),n.d(r,"createSecret",(function(){return qt})),n.d(r,"updateSecret",(function(){return Kt})),n.d(r,"renameSecret",(function(){return Jt})),n.d(r,"deleteSecret",(function(){return $t})),n.d(r,"createSecretUserRights",(function(){return Xt})),n.d(r,"updateSecretUserRights",(function(){return Zt})),n.d(r,"deleteSecretUserRights",(function(){return en})),n.d(r,"addSecretToFolder",(function(){return tn})),n.d(r,"removeSecretFromCurrentFolder",(function(){return nn})),n.d(r,"default",(function(){return rn}));var s={};n.r(s),n.d(s,"ShowSecretUISlice",(function(){return on})),n.d(s,"showModal",(function(){return ln})),n.d(s,"showSecretSuccess",(function(){return dn})),n.d(s,"hideModal",(function(){return un})),n.d(s,"changeTab",(function(){return hn})),n.d(s,"updateSecretStart",(function(){return pn})),n.d(s,"updateSecretFailure",(function(){return bn})),n.d(s,"createSecretUserRightsFailure",(function(){return jn})),n.d(s,"updateSecretUserRightsFailure",(function(){return fn})),n.d(s,"deleteSecretUserRightsFailure",(function(){return mn})),n.d(s,"historyShowOlder",(function(){return gn})),n.d(s,"historyShowNewer",(function(){return On})),n.d(s,"showSecret",(function(){return vn})),n.d(s,"default",(function(){return yn}));var a={};n.r(a),n.d(a,"EditSecretUISlice",(function(){return xn})),n.d(a,"updateData",(function(){return Cn})),n.d(a,"changeField",(function(){return kn})),n.d(a,"default",(function(){return Un}));var i={};n.r(i),n.d(i,"NewSecretUISlice",(function(){return Sr})),n.d(i,"showModal",(function(){return kr})),n.d(i,"hideModal",(function(){return Ur})),n.d(i,"changeTitle",(function(){return Nr})),n.d(i,"changeField",(function(){return Fr})),n.d(i,"default",(function(){return Tr}));var o={};n.r(o),n.d(o,"OptionsSlice",(function(){return Ar})),n.d(o,"_activateTotp",(function(){return Lr})),n.d(o,"_activateShortLogin",(function(){return Mr})),n.d(o,"_toggleTotp",(function(){return Rr})),n.d(o,"_toggleShortLogin",(function(){return Dr})),n.d(o,"activateTotpFailure",(function(){return Er})),n.d(o,"activateTotpSuccess",(function(){return zr})),n.d(o,"hideQRCode",(function(){return Br})),n.d(o,"hideShortLogin",(function(){return _r})),n.d(o,"deactivateTotpSuccess",(function(){return Gr})),n.d(o,"deactivateShortLoginSuccess",(function(){return Hr})),n.d(o,"activateShortLoginSuccess",(function(){return Yr})),n.d(o,"changeDelaySuccess",(function(){return Vr})),n.d(o,"changeDefaultUsernameSuccess",(function(){return Wr})),n.d(o,"changeNewPass1",(function(){return Qr})),n.d(o,"changeNewPass2",(function(){return qr})),n.d(o,"showChangePassword",(function(){return Kr})),n.d(o,"hideChangePassword",(function(){return Jr})),n.d(o,"_changePassword",(function(){return $r})),n.d(o,"changePasswordSuccess",(function(){return Xr})),n.d(o,"changePasswordFailure",(function(){return Zr})),n.d(o,"showRescueCodesSuccess",(function(){return es})),n.d(o,"hideRescueCodes",(function(){return ts})),n.d(o,"deactivateTotp",(function(){return ns})),n.d(o,"activateTotp",(function(){return rs})),n.d(o,"activateShortLogin",(function(){return ss})),n.d(o,"deactivateShortLogin",(function(){return as})),n.d(o,"changePassword",(function(){return is})),n.d(o,"toggleTotp",(function(){return os})),n.d(o,"showRescueCodes",(function(){return cs})),n.d(o,"toggleShortLogin",(function(){return ls})),n.d(o,"toggleAutoLogout",(function(){return ds})),n.d(o,"changeDefaultUsername",(function(){return us})),n.d(o,"changeTimeToClose",(function(){return hs})),n.d(o,"default",(function(){return ps}));var c={};n.r(c),n.d(c,"ImportSlice",(function(){return Cs})),n.d(c,"showModal",(function(){return Us})),n.d(c,"_importSecrets",(function(){return Ns})),n.d(c,"detectTypeFailure",(function(){return Fs})),n.d(c,"detectTypeSuccess",(function(){return Ts})),n.d(c,"importSecretsProgress",(function(){return Ps})),n.d(c,"importSecretsSuccess",(function(){return As})),n.d(c,"importSecretsFailure",(function(){return Is})),n.d(c,"defaultStore",(function(){return Ls})),n.d(c,"changeMandatoryField",(function(){return Ms})),n.d(c,"detectType",(function(){return Rs})),n.d(c,"importSecrets",(function(){return Ds})),n.d(c,"default",(function(){return Es}));var l=n(1),d=n.n(l),u=n(23),h=n.n(u),p=n(5),b=n(6),j=n(9),f=n(7),m=n(8),g=n(10),O=n(32),v=n(12),y=n(37),w=n.n(y),x=n(225),S=n.n(x),C="https://api.secret-in.me";"undefined"!==typeof window.process&&(C=new URLSearchParams(window.location.search).get("api"));var k=new w.a(S.a,w.a.API.Server,C),U=Object(v.a)({},w.a.Statuses),N=Object(v.a)({},w.a.Errors),F=k,T=n(34),P=U.DecryptMetadataStatus,A=U.EndDecryptMetadataStatus,I=U.DecryptUserOptionsStatus,L=U.DecryptMetadataCacheStatus,M=N.UsernameAlreadyExistsError,R=N.UserNotFoundError,D=N.InvalidPasswordError,E=N.NeedTOTPTokenError,z=function(e){e.loading=!0},B=function(e){e.loading=!1},_=Object(T.b)({name:"AppUI",initialState:{savedUsername:F.getSavedUsername(),loading:!1,connected:!1,online:!0,errors:{},currentUser:null,status:null,showShortpass:F.canITryShortLogin()},reducers:{loading:z,endLoading:B,createSecret:z,createSecretSuccess:B,createSecretFailure:B,connectionChange:function(e,t){e.online="online"===t.payload.connection},disconnectUserSuccess:function(e){e.savedUsername=F.getSavedUsername(),e.showShortpass=F.canITryShortLogin(),e.loading=!1,e.connected=!1,e.errors={},e.currentUser=null},createUserSuccess:function(e,t){e.loading=!1,e.connected=!0,e.errors={},e.currentUser=t.payload.currentUser},createUserFailure:function(e,t){e.loading=!1,e.connected=!1,e.errors=t.payload.error,e.status=null},disableShortLoginSuccess:B,onLoginUserProgress:function(e,t){var n=t.payload.status;n&&(e.status=Object(v.a)({},n))},loginUserSuccess:function(e,t){var n=t.payload.currentUser;e.loading=!1,e.connected=!0,e.errors={},e.status=null,e.currentUser=n},loginUserFailure:function(e,t){var n=t.payload.error;e.loading=!1,e.connected=!1,e.errors=n,e.status=null},addSecretToFolderFailure:function(e,t){var n=t.payload.error;e.errors=n},removeSecretFromCurrentFolderFailure:function(e,t){var n=t.payload.error;e.errors=n},hideShortpass:function(e){e.showShortpass=!1}}}),G=_.actions,H=G.loading,Y=(G.endLoading,G.createSecret,G.createSecretSuccess),V=G.createSecretFailure,W=G.disconnectUserSuccess,Q=G.connectionChange,q=G.createUserSuccess,K=G.createUserFailure,J=G.disableShortLoginSuccess,$=G.onLoginUserProgress,X=G.loginUserSuccess,Z=G.loginUserFailure,ee=G.addSecretToFolderFailure,te=G.removeSecretFromCurrentFolderFailure,ne=G.hideShortpass,re=function(e){var t=e.username,n=e.password,r=e.confirmPassword;return function(e){e(H()),n!==r?setTimeout((function(){return e(K({error:{confirmPassword:"Passwords mismatch"}}))}),100):F.newUser(t,n).then((function(t){return e(q({currentUser:t}))})).catch((function(t){if(t instanceof M)return e(K({error:{username:"User already exists"}}));if(t.message.startsWith("The password"))return e(K({error:{password:t.message}}));throw t}))}},se=function(e){var t=e.username,n=e.password,r=e.token;return function(e){console.time("decrypt"),e(H()),F.loginUser(t,n,r,(function(){return e(ae.apply(void 0,arguments))}),!1).then((function(t){return e(X({currentUser:t,options:Object(v.a)(Object(v.a)({},t.options),{},{totp:t.totp,shortLogin:F.canITryShortLogin()}),metadata:t.metadatas}))})).catch((function(t){if(t instanceof R)return e(Z({error:{username:"User not found"}}));if(t instanceof D)return e(Z(r?{error:{totp:"Token",password:"Invalid password",token:"or invalid token"}}:{error:{password:"Invalid password"}}));if(t instanceof E)return e(Z({error:{totp:"Token"}}));throw t}))}},ae=function(e){return function(t,n){var r=F.currentUser;switch(e.constructor){case L:case P:case I:var s=n().AppUI.status;if(s){var a=s.state,i=s.total;if(a&&i&&Math.round(e.state/e.total*100)===Math.round(a/i*100))return}return t($({status:e}));case A:return t(X({currentUser:r,options:Object(v.a)(Object(v.a)({},r.options),{},{totp:r.totp,shortLogin:F.canITryShortLogin()}),metadata:r.metadatas})),console.timeEnd("decrypt"),t($({status:null}));default:return}}},ie=_.reducer,oe=n(57),ce=Object(oe.a)((function(e){return e.Metadata.metadata}),(function(e){return Object.values(e).filter((function(e){return"folder"!==e.type}))})),le=Object(oe.a)(ce,(function(e){return e.AppUI.currentUser}),(function(e,t){return e?e.filter((function(e){var n=e.users.find((function(e){return e.username===t.username}));return 2===(null===n||void 0===n?void 0:n.rights)})):[]})),de=Object(oe.a)((function(e){return e.Metadata.metadata}),(function(e){return e.AppUI.currentUser}),(function(e,t){return t}),(function(e,t,n){if(!t||!e)return{};var r=t.username;return Object.values(e).filter((function(e){var t=e.users.find((function(e){return e.id===r})),s=(null===t||void 0===t?void 0:t.folders)||{};return!n&&s.ROOT||n&&Object.keys(s).includes(n)}))})),ue=Object(oe.a)(ce,(function(e){return e?e.filter((function(e){return e.users.length>1})):[]})),he=n(51),pe=n(226),be=n(489),je=n(227),fe=n.n(je),me=n(15),ge=n.n(me),Oe=n(17),ve=n(0),ye={small:18,base:24},we=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.size,r=ge()("icon","icon--id-".concat(t),this.props.className,Object(Oe.a)({},"icon--size-".concat(n),"string"===typeof n));return Object(ve.jsx)("svg",{className:r,width:"string"===typeof n?ye[n]:n,height:"string"===typeof n?ye[n]:n,children:Object(ve.jsx)("use",{xlinkHref:"#".concat(t)})})}}]),n}(l.Component);we.defaultProps={size:"base",className:""};var xe=we;function Se(e){var t=ge()("modal",e.className,{"modal--centered":e.centered});return Object(ve.jsx)(fe.a,{className:t,backdropClassName:"modal-backdrop",show:e.show,onHide:e.closeOnBackdropClick?e.onClose:void 0,children:Object(ve.jsxs)("div",{className:"modal-dialog",children:[e.onClose&&Object(ve.jsx)("button",{className:"modal-dialog-close",onClick:e.onClose,children:Object(ve.jsx)(xe,{id:"close",size:"small"})}),e.children]})})}Se.defaultProps={centered:!1},Se.Body=function(e){return Object(ve.jsx)("div",{className:"modal-body",children:e.children})},Se.Header=function(e){return Object(ve.jsx)("div",{className:"modal-header",children:Object(ve.jsx)("h2",{className:"modal-header-title",children:e.title||e.children})})},Se.Footer=function(e){return Object(ve.jsx)("div",{className:"modal-footer",children:e.children})};var Ce=Se,ke=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleClick=r.handleClick.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"handleClick",value:function(){this.props.disabled||this.props.onClick()}},{key:"render",value:function(){var e=ge()("button","button--style-".concat(this.props.buttonStyle),"button--size-".concat(this.props.size));return this.props.to?Object(ve.jsx)(O.b,{className:e,title:this.props.title,onClick:this.handleClick,to:this.props.to,disabled:this.props.disabled,children:this.props.children}):Object(ve.jsx)("button",{className:e,name:this.props.name,title:this.props.title,type:this.props.type,form:this.props.form,onClick:this.handleClick,disabled:this.props.disabled,tabIndex:this.props.tabIndex,children:this.props.children})}}]),n}(l.Component);ke.defaultProps={type:"button",size:"base",form:null,buttonStyle:"primary",onClick:function(){return{}},disabled:!1};var Ue=ke,Ne=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(ve.jsxs)(ve.Fragment,{children:[Object(ve.jsx)(Ce.Header,{title:"Welcome to Secret-in.me"}),Object(ve.jsx)(Ce.Body,{children:Object(ve.jsxs)("div",{children:[Object(ve.jsxs)("p",{children:[Object(ve.jsx)("a",{href:"https://my.secret-in.me",target:"_blank",rel:"noopener noreferrer",children:"Secret-in.me"})," ","is a team-oriented"," ",Object(ve.jsx)("a",{href:"https://github.com/secretin",target:"_blank",rel:"noopener noreferrer",children:"open source"})," ","password manager with a focus on transparency, usability and security."]}),Object(ve.jsx)("p",{children:"If it's your first time here, you can create a user and start saving your secrets."}),Object(ve.jsxs)("p",{children:["Be careful, all your secrets will be protected by the password you pick. There is ",Object(ve.jsx)("b",{children:"no way"})," to retrieve your secrets if you forget your password !"]}),Object(ve.jsxs)("p",{children:["This secret manager is freely provided with"," ",Object(ve.jsx)("span",{role:"img","aria-label":"red-heart-emoji",children:"\u2764\ufe0f"})," ","by"," ",Object(ve.jsx)("a",{href:"https://bug.builders",target:"_blank",rel:"noopener noreferrer",children:"Bug Builders."})]}),Object(ve.jsxs)("p",{children:["If you enjoy it, please consider"," ",Object(ve.jsx)("a",{href:"https://donorbox.org/secret-in-me/",target:"_blank",rel:"noopener noreferrer",children:Object(ve.jsx)("b",{children:"donating !"})})," "]}),Object(ve.jsx)("p",{children:"It'll help us support hosting costs (~50$ per month)."})]})})]})}}]),n}(l.Component),Fe=Ne,Te=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(ve.jsxs)(Ce,{show:this.props.showModal,onClose:null!==this.props.acknowledgedVersion&&this.props.hideNews,children:[null===this.props.acknowledgedVersion?Object(ve.jsx)(Fe,{}):Object(ve.jsxs)(ve.Fragment,{children:[Object(ve.jsx)(Ce.Header,{title:"What's new ?"}),Object(ve.jsx)(Ce.Body,{children:this.props.news.map((function(e){return Object(ve.jsxs)("div",{children:[Object(ve.jsx)("h2",{children:e.title}),Object(ve.jsx)("p",{children:e.description})]},e.version)}))})]}),Object(ve.jsxs)(Ce.Footer,{children:[null!==this.props.acknowledgedVersion&&Object(ve.jsx)(Ue,{type:"reset",buttonStyle:"default",onClick:this.props.hideNews,children:Object(ve.jsx)(be.a,{id:"Close"})}),Object(ve.jsx)(Ue,{type:"submit",onClick:this.props.acknowledgeVersion,children:"OK"})]})]})}}]),n}(l.Component),Pe=Te;function Ae(e){return Me[e]}function Ie(){return window.navigator.language&&Le[window.navigator.language]?window.navigator.language:"en"}var Le={en:"English",fr:"Fran\xe7ais"},Me={en:{login:"Username",password:"Password","Sign up":"Sign up","Sign in":"Sign in",confirmPassword:"Confirm password",alreadyHaveAccount:"I already have an account",SignInSubtext:"sign in",logout:"Log out",dontHaveAccount:"I don't have an account",SignUpSubtext:"create one",defaultLanguage:"Language",donate:"Donate",all:"All","my secrets":"My secrets","shared secrets":"Shared secrets",settings:"Settings","export secrets":"Export secrets","import secrets":"Importer secrets","new secret":"Secret","new folder":"Folder",search:"Search...","Last modified":"Last modified","Shared with":"Shared with",Title:"Title","create folder title":"Add new folder","create secret title":"Add new secret","add folder button":"Add folder","add secret button":"Add secret",Close:"Close",shareWarning:"You are about to give",latest:"(latest)",oldest:"(oldest)","Secret title":"Secret title",Copy:"Copy",Open:"Open",url:"url",to:"to",on:"on","Share the secret":"Share the secret","Read only":"Read only","Read and write":"Read and write","Read, write and share":"Read, write and share","You don't have the permission to share this secret":"You don't have the permission to share this secret","You can't modify or remove yourself":"You can't modify or remove yourself","Generate strong":"Generate strong","Generate alphanumeric":"Generate alphanumeric","Generate pronounceable":"Generate pronounceable",Details:"Details","Who has access":"Who has access",History:"History",Save:"Save","Untitled secret":"Untitled secret","Untitled folder":"Untitled folder","Folder title":"Folder title",Cancel:"Cancel"},fr:{login:"Nom d'utilisateur",password:"Mot de passe","Sign up":"Cr\xe9er un compte","Sign in":"Se connecter",logout:"D\xe9connexion",confirmPassword:"Confirmer le mot de passe",alreadyHaveAccount:"J'ai d\xe9j\xe0 un compte",SignInSubtext:"me connecter",dontHaveAccount:"Je n'ai pas de compte",SignUpSubtext:"m'enregistrer",defaultLanguage:"Langue de l'interface",donate:"Faire un don",all:"Tous les secrets","my secrets":"Mes secrets","shared secrets":"Secrets partag\xe9s",settings:"Param\xe8tres","export secrets":"Exporter mes secrets","import secrets":"Importer des secrets","new secret":"Secret","new folder":"Dossier",search:"Rechercher...","Last modified":"Derni\xe8re modification","Shared with":"Partag\xe9 avec",Title:"Titre","create folder title":"Ajout d'un dossier","create secret title":"Ajout d'un secret","Folder title":"Titre du dossier","Secret title":"Titre du secret",Cancel:"Annuler","add folder button":"Cr\xe9er le dossier","add secret button":"Cr\xe9er le secret",Copy:"Copier","Untitled folder":"Dossier sans titre","Untitled secret":"Secret sans titre",Open:"Ouvrir",Close:"Fermer",Details:"D\xe9tails","Who has access":"Partage",History:"Historique",Save:"Sauvegarder","read access":"lecture","read and write access":"lecture et \xe9criture","read, write and share access":"lecture, \xe9criture et partage","Are you sure?":"\xcates-vous s\xfbr\xb7e ?",shareWarning:"Vous vous appr\xeatez \xe0 donner les droits de",to:"\xe0",on:"sur","Share the secret":"Partager le secret","Read only":"Lecture seule","Read and write":"Lecture et \xe9criture","Read, write and share":"Lecture, \xe9criture et partage","You don't have the permission to share this secret":"Vous n'avez pas la permission de partager ce secret","You can't modify or remove yourself":"Vous ne pouvez pas modifier vos propres permissions","Generate strong":"Mot de passe fort","Generate alphanumeric":"Mot de passe alphanum\xe9rique","Generate pronounceable":"Mot de passe pronon\xe7able",latest:"(le plus r\xe9cent)",oldest:"(le plus ancien)",url:"url"}},Re=n(26),De=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onChange=function(e){var t=e.target;r.props.onChange({name:r.props.name,value:t.value})},r.getValue=function(){return r.select.value},r.id=Object(Re.uniqueId)("input_"),r}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=ge()("input","input--type-select","input--size-".concat(this.props.size));return Object(ve.jsxs)("div",{className:t,children:[this.props.label&&Object(ve.jsxs)("label",{htmlFor:this.id,children:[this.props.label,this.props.actions.length>0&&Object(ve.jsx)("span",{className:"input-label-actions",children:this.props.actions})]}),Object(ve.jsxs)("div",{className:"input--type-select--input",children:[Object(ve.jsx)("select",{ref:function(t){e.select=t},value:this.props.value,disabled:this.props.disabled,title:this.props.title,onChange:this.onChange,children:this.props.options.map((function(e){return Object(ve.jsx)("option",{value:e[0],children:e[1]},e[0])}))}),Object(ve.jsx)(xe,{id:"arrow-down"})]})]})}}]),n}(l.Component);De.defaultProps={disabled:!1,size:"base",onChange:Re.noop,actions:[]};var Ee=De,ze="Secret-in:acknowledgedVersion",Be=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;Object(p.a)(this,n),(r=t.call(this,e)).showNews=function(){return r.setState({showModal:!0})},r.hideNews=function(){return r.setState({showModal:!1})},r.acknowledgeVersion=function(){window.localStorage.setItem(ze,r.state.commit),r.setState({news:[],acknowledgeVersion:r.state.commit,showModal:!1})};var s=SECRETIN_APP_COMMIT,a=window.localStorage.getItem(ze);return r.state={commit:s,acknowledgedVersion:a,news:[],showModal:!a,defaultLanguage:localStorage.getItem("defaultLanguage")||Ie()},r}return Object(b.a)(n,[{key:"onChangeUserLanguage",value:function(e){localStorage.setItem("defaultLanguage",e),this.setState({defaultLanguage:e}),this.props.onChangeLanguage()}},{key:"componentDidMount",value:function(){var e=this;null!==this.state.acknowledgedVersion&&("develop"!==this.state.commit&&this.state.acknowledgedVersion!==this.state.commit&&fetch("https://raw.githubusercontent.com/secretin/secretin-website/develop/changelog.json").then((function(e){return e.json()})).then((function(t){var n,r=[],s=!1,a=Object(pe.a)(t.changelog);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.version===e.state.acknowledgedVersion){s=!0;break}r.push(i)}}catch(o){a.e(o)}finally{a.f()}s?e.setState({news:r}):e.setState({news:[t.changelog[0]]})})).catch((function(){})))}},{key:"render",value:function(){var e=this,t=this.state.commit?this.state.commit.substr(0,7):"",n=this.state.defaultLanguage;return Object(ve.jsxs)("div",{className:"footer",children:[Object(ve.jsx)(Pe,{news:this.state.news,acknowledgeVersion:this.acknowledgeVersion,acknowledgedVersion:this.state.acknowledgedVersion,hideNews:this.hideNews,showModal:this.state.showModal}),Object(ve.jsxs)("span",{className:"secretin-version",children:[this.state.news.length>0&&Object(ve.jsx)("span",{className:"new-in-secretin-version",onClick:this.showNews,children:"\u2022"}),Object(ve.jsxs)("span",{className:"secretin-version-text",children:["secretin-app"," ",Object(ve.jsx)("a",{href:"https://github.com/secretin/secretin-app/commit/".concat(this.state.commit),rel:"noopener noreferrer",target:"_blank",children:t})]})]}),Object(ve.jsx)("span",{className:"secretin-version",children:Object(ve.jsxs)("span",{className:"secretin-version-text",children:["secretin-lib v",w.a.version]})}),Object(ve.jsx)("span",{className:"secretin-version",children:Object(ve.jsx)("span",{className:"secretin-version-text",children:Object(ve.jsxs)("a",{href:"https://donorbox.org/secret-in-me/",target:"_blank",rel:"noopener noreferrer",children:[Object(ve.jsx)("span",{role:"img","aria-label":"red-heart-emoji",children:"\u2764\ufe0f"})," ",Object(ve.jsx)("b",{children:Object(ve.jsx)(be.a,{id:"donate"})}),Object(ve.jsx)("span",{role:"img","aria-label":"red-heart-emoji",children:"\u2764\ufe0f"})," "]})})}),Object(ve.jsx)(Ee,{value:n,label:Object(ve.jsx)(be.a,{id:"defaultLanguage"}),options:Object.entries(Le).map((function(e){var t=Object(he.a)(e,2);return[t[0],t[1]]})),size:"extra-small",title:"Preferred language",onChange:function(t){var n=t.value;return e.onChangeUserLanguage(n)}})]})}}]),n}(l.Component),_e=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).id=e.id||Object(Re.uniqueId)("form_"),r.onSubmit=r.onSubmit.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"onSubmit",value:function(e){e.preventDefault(),this.props.disabled||this.props.onSubmit()}},{key:"render",value:function(){var e=ge()("form",this.props.className);return Object(ve.jsxs)("form",{id:this.id,className:e,onSubmit:this.onSubmit,autoComplete:this.props.autoComplete?null:"new-password",children:[!this.props.autoComplete&&[Object(ve.jsx)("input",{name:"autofill_trap_email",type:"text",style:{display:"none"}},"autofill_trap_email"),Object(ve.jsx)("input",{name:"autofill_trap_password",type:"password",style:{display:"none"}},"autofill_trap_password")],Object(ve.jsx)("input",{type:"submit",style:{display:"none"}}),this.props.children]})}}]),n}(l.Component);_e.defaultProps={disabled:!1,autoComplete:!1,onSubmit:function(){return{}}};var Ge=_e,He=n(163),Ye=n.n(He),Ve=n(229),We=n.n(Ve);Ye.a.MenuItem=function(e){return Object(ve.jsx)(We.a,Object(v.a)({className:"dropdown-menu-item"},e))};var Qe=Ye.a,qe=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(j.a)(r)),r.onTogglePasswordShow=r.onTogglePasswordShow.bind(Object(j.a)(r)),r.id=Object(Re.uniqueId)("".concat(r.props.name,"_input_")),r.state={autoCompleteSelected:!1,showPassword:!1},r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.autoSelect&&setTimeout((function(){return e.input.select()}),0),this.props.autoFocus&&setTimeout((function(){return e.input.focus()}),0)}},{key:"onTogglePasswordShow",value:function(){this.setState({showPassword:!this.state.showPassword})}},{key:"handleChange",value:function(e){this.state.autoCompleteSelected&&this.setState({autoCompleteSelected:!1}),this.props.onChange({name:this.props.name,value:e.target.value})}},{key:"handleAutoCompleteSelect",value:function(e){this.setState({autoCompleteSelected:!0}),this.props.onChange({name:this.props.name,value:e})}},{key:"select",value:function(){this.input.select()}},{key:"render",value:function(){var e=this,t=ge()("input","input--type-".concat(this.props.type),"input--size-".concat(this.props.size),{"input--error":this.props.error}),n=this.props,r=n.type,s=n.title,a=n.autoComplete,i=n.autoFocus,o=n.disabled,c=n.error,l=n.label,d=n.placeholder,u=n.readOnly,h=n.actions,p=n.inputProps,b=n.autoCompleteFromList,j=this.props.value.length>0?b.filter((function(t){return t.toLowerCase().includes(e.props.value.toLowerCase())})):[];return Object(ve.jsxs)("div",{className:t,children:[l&&Object(ve.jsxs)("label",{htmlFor:this.id,children:[l,h.length>0&&Object(ve.jsx)("span",{className:"input-label-actions",children:h})]}),Object(ve.jsxs)("div",{className:"input--wrapper",children:[Object(ve.jsx)("input",Object(v.a)({id:this.id,ref:function(t){e.input=t},name:this.id,title:s,type:"password"===r&&this.state.showPassword?"text":r,value:this.props.value,onChange:this.handleChange,placeholder:d,autoComplete:a?"on":"off",autoFocus:i,disabled:o,readOnly:u},p)),!this.state.autoCompleteSelected&&j.length>0&&Object(ve.jsx)(Qe,{id:"input--auto-complete-list",open:Boolean(this.props.value.length>0),children:Object(ve.jsx)(Qe.Menu,{children:j.slice(0,5).map((function(t){return Object(ve.jsx)(Qe.MenuItem,{onSelect:function(){return e.handleAutoCompleteSelect(t)},children:t},t)}))})}),"password"===r&&Object(ve.jsx)("div",{className:"input--password-show",children:Object(ve.jsx)(Ue,{title:"Show",buttonStyle:"icon",onClick:this.onTogglePasswordShow,tabIndex:"-1",children:Object(ve.jsx)(xe,{id:this.state.showPassword?"show":"hide",size:"small"})})})]}),c&&Object(ve.jsx)("span",{className:"input-error",children:c})]})}}]),n}(l.Component);qe.defaultProps={type:"text",value:"",autoFocus:!1,autoSelect:!1,autoComplete:!1,autoCompleteFromList:[],disabled:!1,readOnly:!1,actions:[],size:"base",debounce:0};var Ke=qe,Je=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onSubmit=r.onSubmit.bind(Object(j.a)(r)),r.toggleSignup=r.toggleSignup.bind(Object(j.a)(r)),r.handleChange=r.handleChange.bind(Object(j.a)(r)),r.state={signup:!1,username:e.savedUsername,password:"",confirmPassword:"",showShortpass:F.canITryShortLogin()},r}return Object(b.a)(n,[{key:"onSubmit",value:function(e){e&&e.preventDefault(),this.state.signup?this.props.dispatch(re({username:this.state.username,password:this.state.password,confirmPassword:this.state.confirmPassword})):this.props.dispatch(se({username:this.state.username,password:this.state.password,token:this.state.token}))}},{key:"toggleSignup",value:function(e){this.setState({signup:e})}},{key:"handleChange",value:function(e){var t=e.name,n=e.value;this.setState(Object(Oe.a)({},t,n))}},{key:"render",value:function(){var e=this,t=this.state.signup?Object(ve.jsx)(be.a,{id:"Sign up"}):Object(ve.jsx)(be.a,{id:"Sign in"});return Object(ve.jsxs)(Ge,{className:"user-connect-form",disabled:this.props.loading,onSubmit:this.onSubmit,children:[Object(ve.jsx)("h2",{className:"user-connect-title",title:this.props.isOnline&&F.api.db,children:Object(ve.jsx)("img",{src:"/logo.svg",style:{width:"70%"},alt:"logo",title:this.props.isOnline?"Secret-In.me":"Offline"})}),Object(ve.jsx)(Ke,{name:"username",label:Object(ve.jsx)(be.a,{id:"login"}),type:"text",value:this.state.username,onChange:this.handleChange,disabled:this.props.loading,error:this.props.errors.username,autoFocus:""===this.props.savedUsername,autoComplete:!0}),Object(ve.jsx)(Ke,{name:"password",label:Object(ve.jsx)(be.a,{id:"password"}),type:"password",value:this.state.password,onChange:this.handleChange,disabled:this.props.loading,error:this.props.errors.password,autoFocus:""!==this.props.savedUsername}),this.props.errors.totp&&Object(ve.jsx)(Ke,{name:"token",label:"Token",type:"text",value:this.state.token,onChange:this.handleChange,disabled:this.props.loading,error:this.props.errors.token,autoFocus:!0}),this.state.signup&&Object(ve.jsx)(Ke,{name:"confirmPassword",label:Object(ve.jsx)(be.a,{id:"confirmPassword"}),type:"password",value:this.state.confirmPassword,onChange:this.handleChange,disabled:this.props.loading,error:this.props.errors.confirmPassword}),this.props.errors.shortLoginExpired&&Object(ve.jsxs)("h3",{className:"tooltip",children:[this.props.errors.shortLoginExpired.message,Object(ve.jsx)(xe,{id:"info",size:13}),Object(ve.jsx)("span",{className:"tooltiptext",children:this.props.errors.shortLoginExpired.info})]}),Object(ve.jsx)(Ue,{type:"submit",disabled:this.props.loading||Object(Re.isEmpty)(this.state.username)||Object(Re.isEmpty)(this.state.password),children:t}),Object(ve.jsx)("div",{className:"user-connect-create",children:Object(ve.jsx)("span",{children:this.state.signup?Object(ve.jsxs)("span",{children:[Object(ve.jsx)(be.a,{id:"alreadyHaveAccount"}),",\xa0",Object(ve.jsx)("a",{onClick:function(){e.toggleSignup(!e.state.signup)},tabIndex:"-1",children:Object(ve.jsx)(be.a,{id:"SignInSubtext"})})]}):Object(ve.jsxs)("span",{children:[Object(ve.jsx)(be.a,{id:"dontHaveAccount"}),",\xa0",Object(ve.jsx)("a",{onClick:function(){e.toggleSignup(!e.state.signup)},tabIndex:"-1",children:Object(ve.jsx)(be.a,{id:"SignUpSubtext"})})]})})})]})}}]),n}(l.Component),$e=Object(g.b)((function(e){return{isOnline:e.AppUI.online}}))(Je),Xe=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleAccept=r.handleAccept.bind(Object(j.a)(r)),r.handleCancel=r.handleCancel.bind(Object(j.a)(r)),r.promise=new Promise((function(e,t){r.accept=e,r.cancel=t})),r.state={used:!1},r}return Object(b.a)(n,[{key:"handleAccept",value:function(){this.setState({used:!0}),this.accept()}},{key:"handleCancel",value:function(){this.setState({used:!0}),this.cancel()}},{key:"render",value:function(){return Object(ve.jsxs)(Ce,{show:!0,centered:!0,onClose:this.promise.reject,children:[this.props.title&&Object(ve.jsx)(Ce.Header,{children:this.props.title}),Object(ve.jsx)(Ce.Body,{children:this.props.text}),Object(ve.jsxs)(Ce.Footer,{children:[Object(ve.jsx)(Ue,{type:"reset",buttonStyle:"default",onClick:this.handleCancel,disabled:this.state.used,children:this.props.cancelLabel}),Object(ve.jsx)(Ue,{buttonStyle:"primary",onClick:this.handleAccept,disabled:this.state.used,children:this.props.acceptLabel})]})]})}}]),n}(l.Component);function Ze(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=document.body.appendChild(document.createElement("div")),n=h.a.render(d.a.createElement(Xe,e),t);return n.promise.then(e.onAccept).catch(e.onCancel).then((function(){h.a.unmountComponentAtNode(t),setTimeout((function(){return t.remove()}))}))}var et=n(28),tt=n.n(et),nt=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(j.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(j.a)(r)),r.handleDisable=r.handleDisable.bind(Object(j.a)(r)),r.state={shortpass:""},r}return Object(b.a)(n,[{key:"handleChange",value:function(e){this.setState({shortpass:e.value})}},{key:"handleSubmit",value:function(){this.props.dispatch(function(e){var t=e.shortpass;return function(e){e(H()),F.shortLogin(t,(function(){return e(ae.apply(void 0,arguments))}),!1).then((function(t){e(X({currentUser:t,options:Object(v.a)(Object(v.a)({},t.options),{},{totp:t.totp,shortLogin:F.canITryShortLogin()}),metadata:t.metadatas}))})).catch((function(){e(Z({error:{shortlogin:"Expired shortpass"}})),setTimeout((function(){e(ne())}),1e3)}))}}({shortpass:this.state.shortpass}))}},{key:"handleDisable",value:function(){var e=this;Ze({title:"Are you sure?",text:Object(ve.jsx)("span",{children:"This will disable your short pass login access."}),acceptLabel:"Disable short pass",cancelLabel:"Cancel",onAccept:function(){e.props.dispatch((function(e){e(H()),F.deactivateShortLogin(),e(J()),e(ne())}))},onCancel:function(){return{}}})}},{key:"render",value:function(){var e=F.getShortLoginActivationDate(),t=e?" (expires "+tt()(e).add(7,"days").fromNow()+")":"";return Object(ve.jsxs)(Ge,{className:"user-connect-form",disabled:this.props.loading,onSubmit:this.handleSubmit,children:[Object(ve.jsxs)("h2",{className:"user-connect-title",children:["Hello again ",this.props.savedUsername,"!"]}),Object(ve.jsx)(Ke,{label:"Shortpass".concat(t),name:"shortpass",value:this.state.shortpass,type:"password",onChange:this.handleChange,error:this.props.error,autoFocus:!0}),Object(ve.jsx)(Ue,{type:"button",buttonStyle:"primary",disabled:this.props.loading||Object(Re.isEmpty)(this.state.shortpass),onClick:this.handleSubmit,children:"Connect"}),Object(ve.jsx)("a",{className:"user-connect-more",tabIndex:-1,onClick:this.handleDisable,children:"Use another account"})]})}}]),n}(l.Component),rt=Object(g.b)()(nt),st=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onSubmit=r.onSubmit.bind(Object(j.a)(r)),r.toggleSignup=r.toggleSignup.bind(Object(j.a)(r)),r.handleChange=r.handleChange.bind(Object(j.a)(r)),r.state={signup:!1,username:"",password:""},r}return Object(b.a)(n,[{key:"onSubmit",value:function(e){e&&e.preventDefault(),this.state.signup?this.props.dispatch(re({username:this.state.username,password:this.state.password})):this.props.dispatch(se({username:this.state.username,password:this.state.password,token:this.state.token}))}},{key:"toggleSignup",value:function(e){var t=e.checked;this.setState({signup:t})}},{key:"handleChange",value:function(e){var t=e.name,n=e.value;this.setState(Object(Oe.a)({},t,n))}},{key:"render",value:function(){var e=this.props,t=e.savedUsername,n=e.loading,r=e.errors,s=e.showShortpass,a=F.getShortLoginActivationDate(),i=!!a&&tt()(a).add(7,"days").isBefore(tt()());return Object(ve.jsx)("div",{className:"user-connect",children:s&&!i?Object(ve.jsx)(rt,{savedUsername:t,loading:n,error:r.shortlogin}):Object(ve.jsx)($e,{loading:n,savedUsername:t||"",errors:Object(v.a)(Object(v.a)({},r),a&&i?{shortLoginExpired:{message:"Your shortpass has expired ",info:"Previous shortpass will automatically reactivate for your account ".concat(t," if you sign-in.")}}:{})})})}}]),n}(l.Component),at=Object(g.b)((function(e){var t=e.AppUI;return{showShortpass:t.showShortpass,status:t.status}}))(st),it=n(25),ot=n(230),ct=["children"];function lt(e){var t=e.children,n=Object(ot.a)(e,ct);return Object(ve.jsx)("li",{className:"sidebar-menu-item",children:Object(ve.jsx)(O.c,Object(v.a)(Object(v.a)({className:"sidebar-menu-link",activeClassName:"sidebar-menu-link--active"},n),{},{children:t}))})}function dt(){F.exportDb().then((function(e){!function(e,t){var n=document.createElement("a");n.setAttribute("href","data:application/json;charset=utf-8,".concat(encodeURIComponent(t))),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}("Secret-in_".concat(F.currentUser.username,"_").concat(tt()().format(),".json"),e)}))}var ut=function(){var e=Object(g.d)((function(e){return e.AppUI.currentUser})),t=Object(g.d)((function(e){return e.AppUI.online}));return Object(ve.jsxs)("div",{className:"sidebar",children:[Object(ve.jsx)("div",{className:"sidebar-header",children:Object(ve.jsx)(O.b,{to:"/",title:t&&F.api.db,children:Object(ve.jsx)("img",{src:"/logo.svg",style:{width:"100%"},alt:"logo",title:t?"Secret-In.me":"Offline"})})}),Object(ve.jsx)("div",{className:"sidebar-content",children:Object(ve.jsxs)("ul",{className:"sidebar-menu",children:[Object(ve.jsxs)(lt,{to:"/secrets/",exact:!0,children:[Object(ve.jsx)(xe,{id:"home",size:"base"}),e.username]}),Object(ve.jsx)("div",{className:"sidebar-separator"}),Object(ve.jsxs)(lt,{to:"/secrets/all/",children:[Object(ve.jsx)(xe,{id:"apps",size:"base"}),Object(ve.jsx)(be.a,{id:"all"})]}),Object(ve.jsxs)(lt,{to:"/secrets/mine",exact:!0,children:[Object(ve.jsx)(xe,{id:"user",size:"base"}),Object(ve.jsx)(be.a,{id:"my secrets"})]}),Object(ve.jsxs)(lt,{to:"/secrets/shared",exact:!0,children:[Object(ve.jsx)(xe,{id:"people",size:"base"}),Object(ve.jsx)(be.a,{id:"shared secrets"})]}),Object(ve.jsx)("div",{className:"sidebar-separator"}),Object(ve.jsxs)(lt,{to:"/settings/",children:[Object(ve.jsx)(xe,{id:"gear",size:"base"}),Object(ve.jsx)(be.a,{id:"settings"})]}),Object(ve.jsx)("div",{className:"sidebar-separator"}),Object(ve.jsx)("li",{className:"sidebar-menu-item",children:Object(ve.jsxs)("a",{className:"sidebar-menu-link",onClick:dt,children:[Object(ve.jsx)(xe,{id:"export",size:"base"}),Object(ve.jsx)(be.a,{id:"export secrets"})]})}),Object(ve.jsxs)(lt,{to:"/import/",children:[Object(ve.jsx)(xe,{id:"import",size:"base"}),Object(ve.jsx)(be.a,{id:"import secrets"})]}),Object(ve.jsx)("div",{className:"sidebar-separator"}),Object(ve.jsx)("li",{className:"sidebar-menu-item",children:Object(ve.jsxs)("a",{className:"sidebar-menu-link",onClick:function(){return window.location.reload()},children:[Object(ve.jsx)(xe,{id:"logout",size:"base"}),Object(ve.jsx)(be.a,{id:"logout"})]})})]})})]})},ht=n(18),pt=n(116),bt=n(117),jt=n(69),ft=n.n(jt),mt=n(52),gt=n.n(mt),Ot=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e),this.id=t.id||gt.a.v4(),this.date=t.date||null,this.type=t.type||"text",this.label=t.label||"",this.content=t.content||""}return Object(b.a)(e,[{key:"getRaw",value:function(){return{id:this.id,date:this.date,type:this.type,label:this.label,content:this.content}}}],[{key:"createFromRaw",value:function(t){var n=Object(v.a)(Object(v.a)({},t),{},{content:t.content});return n.value&&delete n.value,new e(n)}}]),e}(),vt=Ot,yt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e),this.type=t.type||"default",this.fields=t.fields||[]}return Object(b.a)(e,[{key:"addNewField",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.fields.push(new vt(e).getRaw()),this}},{key:"getRaw",value:function(){return{type:this.type,fields:this.fields}}}],[{key:"createWithDefaultFields",value:function(t){return t.reduce((function(e,t){return e.addNewField(t)}),new e)}},{key:"createFromRaw",value:function(t){return new e(Object.entries(t).reduce((function(e,t){var n=Object(he.a)(t,2),r=n[0],s=n[1];return"fields"===r?Object(v.a)(Object(v.a)({},e),{},{fields:s.map((function(e){return vt.createFromRaw(e).getRaw()}))}):e}),t))}}]),e}();yt.DEFAULT_FIELDS=[{label:"login",type:"text"},{label:"password",type:"password"},{label:"url",type:"url"}];var wt=yt,xt=[0,1,2];function St(e){switch(e){case 0:return"Read only";case 1:return"Read and write";case 2:return"Read, write and share";default:throw new Error('Unknown access rights "'.concat(e,'"'))}}var Ct,kt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e),this.id=t.username||gt.a.v4(),this.username=t.username||"",this.rights=t.rights||0,this.folders=t.folders||{}}return Object(b.a)(e,[{key:"isValid",value:function(){return this.username.length>0}},{key:"merge",value:function(e){var t=this;return Object.entries(e).forEach((function(e){var n=Object(he.a)(e,2),r=n[0],s=n[1];t[r]=s})),this}},{key:"getRaw",value:function(){return{id:this.id,username:this.username,rights:this.rights,folders:this.folders}}}],[{key:"createFromRaw",value:function(t){return new e(t)}}]),e}(),Ut=kt,Nt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e),this.id=t.id||null,this.type=t.type||null,this.title=t.title||null,this.lastModifiedBy=t.lastModifiedBy||null,this.lastModifiedAt=t.lastModifiedAt||null,this.users=t.users||{},this.data=t.data||null}return Object(b.a)(e,[{key:"getIcon",value:function(){switch(this.type){case"folder":return Object.keys(this.users)>1?"folder-shared":"folder";case"secret":default:return"description";case"windows":return"windows"}}},{key:"accessRightForUser",value:function(e){var t;return(null===(t=this.users.find((function(t){return t.id===e.username})))||void 0===t?void 0:t.rights)||0}},{key:"canBeReadBy",value:function(e){return this.accessRightForUser(e)>=0}},{key:"canBeUpdatedBy",value:function(e){return this.accessRightForUser(e)>=1}},{key:"canBeSharedBy",value:function(e){return this.accessRightForUser(e)>=2}},{key:"canBeDeleted",value:function(){return"windows"!==this.type}},{key:"merge",value:function(e){var t=this;return Object.entries(e).forEach((function(e){var n=Object(he.a)(e,2),r=n[0],s=n[1];t[r]=s})),this}},{key:"getRaw",value:function(){var e=this.id,t=this.type,n=this.title,r=this.lastModifiedBy,s=this.lastModifiedAt,a=this.data,i=this.users;return{id:e,type:t,title:n,lastModifiedBy:r,lastModifiedAt:s,data:null===a||void 0===a?void 0:a.getRaw(),users:i.map((function(e){return e.getRaw()}))}}}],[{key:"createFromRaw",value:function(t){return new e(Object.entries(t).reduce((function(e,t){var n=Object(he.a)(t,2),r=n[0],s=n[1];if(!s)return e;switch(r){case"users":return Object(v.a)(Object(v.a)({},e),{},{users:Object.values(s).map((function(e){return Ut.createFromRaw(e)}))});case"data":return Object(v.a)(Object(v.a)({},e),{},{data:wt.createFromRaw(s).getRaw()});case"lastModifiedAt":return Object(v.a)(Object(v.a)({},e),{},{lastModifiedAt:tt()(s)});default:return e}}),t))}}]),e}(),Ft=Nt,Tt=N.FriendNotFoundError,Pt=function(e,t){var n=t.payload.metadata;e.metadata=function(e){return e.map((function(e){return Ft.createFromRaw(e)}))}(Object.values(n));var r=new Set;Object.values(n).forEach((function(e){Object.values(e.users).forEach((function(e){r.add(e.username)}))})),e.knownFriendList=Array.from(r).sort()};function At(){return{metadata:[]}}var It,Lt,Mt=Object(T.b)({name:"Metadata",initialState:{metadata:[]},reducers:{loadMetadataSuccess:Pt,deleteSecretSuccess:Pt,deleteSecretFailure:Pt,addSecretToFolderSuccess:Pt,removeSecretFromCurrentFolderSuccess:Pt,createSecretUserRightsSuccess:Pt,updateSecretSuccess:Pt,renameSecretSuccess:Pt,updateSecretUserRightsSuccess:function(e,t){var n=t.payload,r=n.secret,s=n.user,a=n.rights,i=function(e,t){return e.metadata.findIndex((function(e){return e.id===t}))}(e,r.id);e.metadata[i].users=e.metadata[i].users.map((function(e){return e.id===s.id?e.merge({rights:a}):e}))},deleteSecretUserRightsSuccess:function(e,t){var n=t.payload,r=n.secret,s=n.user,a=function(e,t){return e.metadata.find((function(e){return e.id===t}))}(e,r.id);a.users=a.users.filter((function(e){return e.id!==s.id}))}},extraReducers:(Ct={},Object(Oe.a)(Ct,Y,Pt),Object(Oe.a)(Ct,X,Pt),Object(Oe.a)(Ct,W,At),Ct)}),Rt=Mt.actions,Dt=Rt.loadMetadataSuccess,Et=Rt.deleteSecretSuccess,zt=Rt.deleteSecretFailure,Bt=Rt.addSecretToFolderSuccess,_t=Rt.removeSecretFromCurrentFolderSuccess,Gt=Rt.createSecretUserRightsSuccess,Ht=Rt.updateSecretSuccess,Yt=Rt.renameSecretSuccess,Vt=Rt.updateSecretUserRightsSuccess,Wt=Rt.deleteSecretUserRightsSuccess,Qt=function(){return function(e){console.time("refresh"),F.refreshUser(!0,(function(){return e(ae.apply(void 0,arguments))})).then((function(){console.timeEnd("refresh"),e(Dt({metadata:F.currentUser.metadatas}))}))}},qt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFolder:!1},t=e.title,n=e.data,r=e.folder,s=e.isFolder;return function(e){return(s?r?F.addFolder(t,r):F.addFolder(t):r?F.addSecret(t,n,r):F.addSecret(t,n)).then((function(){return e(Y({metadata:F.currentUser.metadatas}))})).catch((function(t){throw e(V({error:t})),t}))}},Kt=function(e){var t=e.secret,n=e.data;return function(){var e=Object(bt.a)(ft.a.mark((function e(r){var s;return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(pn()),e.prev=1,s={data:n},e.next=5,F.editSecret(t.id,n);case 5:return e.prev=5,e.next=8,F.getHistory(t.id);case 8:s.history=e.sent,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(5),s.history=[],console.log(e.t0);case 15:r(Ht(Object(v.a)(Object(v.a)({},s),{},{metadata:F.currentUser.metadatas}))),e.next=22;break;case 18:throw e.prev=18,e.t1=e.catch(1),r(bn({error:e.t1})),e.t1;case 22:case"end":return e.stop()}}),e,null,[[1,18],[5,11]])})));return function(t){return e.apply(this,arguments)}}()},Jt=function(e){var t=e.secret,n=e.newTitle;return function(e){return F.renameSecret(t.id,n).then((function(){e(Yt({metadata:F.currentUser.metadatas}))})).catch((function(t){throw e(bn({error:t})),t}))}},$t=function(e){var t=e.secret;return function(e){return F.deleteSecret(t.id).catch((function(t){throw e(zt({metadata:F.currentUser.metadatas})),t})).then((function(){return e(Et({metadata:F.currentUser.metadatas}))}))}},Xt=function(e){var t=e.secret,n=e.user,r=e.rights;return function(e){return F.shareSecret(t.id,n.username,r).then((function(){e(Gt({metadata:F.currentUser.metadatas,user:n,rights:r}))})).catch((function(t){if(t instanceof Tt)return e(jn({error:{username:"User not found"}}));throw e(jn({error:{unknown:"Unknown error"}})),t}))}},Zt=function(e){var t=e.secret,n=e.user,r=e.rights;return function(e){return F.shareSecret(t.id,n.username,r).then((function(){return e(Vt({secret:t,user:n,rights:r}))})).catch((function(t){throw e(fn({error:{unknown:"Unknown error"}})),t}))}},en=function(e){var t=e.secret,n=e.user;return function(e){return F.unshareSecret(t.id,n.username).then((function(){return e(Wt({secret:t,user:n}))})).catch((function(t){throw e(mn({error:{unknown:"Unknown error"}})),t}))}},tn=function(e){var t=e.secret,n=e.folder;return function(e){return F.addSecretToFolder(t.id,n.id).then((function(){return e(Bt({secret:t,folder:n,metadata:F.currentUser.metadatas}))})).catch((function(t){throw e(ee({error:{unknown:"Unknown error"}})),t}))}},nn=function(e){var t=e.secret,n=e.currentFolderId;return function(e){return F.removeSecretFromFolder(t.id,n).then((function(){return e(_t({secret:t,currentFolderId:n,metadata:F.currentUser.metadatas}))})).catch((function(t){throw e(te({error:{unknown:"Unknown error"}})),t}))}},rn=Mt.reducer,sn=function(){return{secret:null,errors:{},tab:"details",isUpdating:!1,historyDepth:0}},an=function(e,t){var n=t.payload.error;e.errors=n,e.isUpdating=!1},on=Object(T.b)({name:"ShowSecretUI",initialState:{secret:null,errors:{},tab:"details",isUpdating:!1,historyDepth:0},reducers:{showModal:function(e,t){var n=t.payload,r=n.secret,s=n.tab;e.secret=r,e.tab=s||"details",e.errors={}},showSecretSuccess:function(e,t){var n=t.payload.secret;e.secret=n,e.errors={}},hideModal:function(e,t){e.secret=null,e.errors={},e.historyDepth=0},changeTab:function(e,t){var n=t.payload.tab;e.tab=n},updateSecretStart:function(e,t){e.isUpdating=!0,e.errors={}},historyShowOlder:function(e){e.historyDepth+1<e.secret.history.length&&(e.historyDepth+=1)},historyShowNewer:function(e){e.historyDepth-1>=0&&(e.historyDepth-=1)},updateSecretFailure:an,createSecretUserRightsFailure:an,updateSecretUserRightsFailure:an,deleteSecretUserRightsFailure:an},extraReducers:(It={},Object(Oe.a)(It,Ht,(function(e,t){var n=t.payload,r=n.metadata,s=n.history,a=r[e.secret.id];a.users=Object.values(a.users).map((function(e){return Ut.createFromRaw(e)})),e.secret=e.secret.merge(r[e.secret.id]),e.secret.history=s,e.isUpdating=!1,e.errors={}})),Object(Oe.a)(It,Gt,(function(e,t){var n=t.payload,r=n.user,s=n.rights;e.secret.users.push(r.merge({rights:s})),e.isUpdating=!1,e.errors={}})),Object(Oe.a)(It,Vt,(function(e,t){var n=t.payload,r=n.rights,s=n.user;e.secret.users=e.secret.users.map((function(e){return e.id===s.id?e.merge({rights:r}):e})),e.isUpdating=!1,e.errors={}})),Object(Oe.a)(It,Wt,(function(e,t){var n=t.payload.user;e.secret.users=e.secret.users.filter((function(e){return e.id!==n.id})),e.isUpdating=!1,e.errors={}})),Object(Oe.a)(It,W,sn),It)}),cn=on.actions,ln=cn.showModal,dn=cn.showSecretSuccess,un=cn.hideModal,hn=cn.changeTab,pn=cn.updateSecretStart,bn=cn.updateSecretFailure,jn=cn.createSecretUserRightsFailure,fn=cn.updateSecretUserRightsFailure,mn=cn.deleteSecretUserRightsFailure,gn=cn.historyShowOlder,On=cn.historyShowNewer,vn=function(e){var t=e.secret,n=e.tab;return function(){var e=Object(bt.a)(ft.a.mark((function e(r){var s,a,i;return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r(ln({secret:t,tab:n})),"folder"!==t.type){e.next=5;break}r(dn({secret:t})),e.next=22;break;case 5:return e.next=7,F.getSecret(t.id);case 7:return s=e.sent,a=s.fields?s:{fields:s},(i=Ft.createFromRaw(t.getRaw())).data=wt.createFromRaw(a).getRaw(),e.prev=11,e.next=14,F.getHistory(t.id);case 14:i.history=e.sent,e.next=21;break;case 17:e.prev=17,e.t0=e.catch(11),console.log(e.t0),i.history=[];case 21:r(dn({secret:i}));case 22:case"end":return e.stop()}}),e,null,[[11,17]])})));return function(t){return e.apply(this,arguments)}}()},yn=on.reducer;function wn(){return{isEditing:!1,data:null}}var xn=Object(T.b)({name:"EditSecretUI",initialState:{isEditing:!1,data:null},reducers:{updateData:function(e,t){e.isEditing=!1,e.data=t.payload.data},changeField:function(e,t){var n=t.payload,r=n.field,s=n.value;e.isEditing=!0;var a=e.data.fields.findIndex((function(e){return e.id===r.id}));e.data.fields[a].content=s}},extraReducers:(Lt={},Object(Oe.a)(Lt,dn,(function(e,t){e.isEditing=!1,e.data=t.payload.secret.data})),Object(Oe.a)(Lt,un,(function(e){e.isEditing=!1,e.data=null})),Object(Oe.a)(Lt,Ht,(function(e){e.isEditing=!1})),Object(Oe.a)(Lt,W,wn),Lt)}),Sn=xn.actions,Cn=Sn.updateData,kn=Sn.changeField,Un=xn.reducer,Nn=n(118),Fn=n.n(Nn),Tn=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onCopy=r.onCopy.bind(Object(j.a)(r)),r.onGenerate=r.onGenerate.bind(Object(j.a)(r)),r.onGenerateAlphanum=r.onGenerateAlphanum.bind(Object(j.a)(r)),r.onGeneratePronounceable=r.onGeneratePronounceable.bind(Object(j.a)(r)),r.handleChange=r.handleChange.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"onCopy",value:function(){Fn()(this.props.field.content,{debug:!0})}},{key:"onGenerate",value:function(){this.handleChange({value:y.Utils.PasswordGenerator.generatePassword()})}},{key:"onGenerateAlphanum",value:function(){this.handleChange({value:y.Utils.PasswordGenerator.generatePassword({contentRules:{numbers:!0,mixedCase:!0,symbols:!1}})})}},{key:"onGeneratePronounceable",value:function(){this.handleChange({value:y.Utils.PasswordGenerator.generatePassword({readable:!0})})}},{key:"handleChange",value:function(e){var t=e.value,n={field:this.props.field,value:t};this.props.onChange(n)}},{key:"render",value:function(){var e=this,t=[];return this.props.isNew||"url"===this.props.field.type&&t.push(Object(ve.jsx)("a",{href:this.props.field.content,target:"_blank",rel:"noopener noreferrer",tabIndex:"-1",children:Object(ve.jsx)(be.a,{id:"Open"})},"open")),t.push(Object(ve.jsx)("a",{onClick:this.onCopy,tabIndex:"-1",children:Object(ve.jsx)(be.a,{id:"Copy"})},"copy")),Object(ve.jsxs)("div",{className:"secret-field",children:[Object(ve.jsx)(Ke,{ref:function(t){e.input=t},label:this.props.intl.formatMessage({id:this.props.field.label}),name:this.props.field.label,value:this.props.field.content,onChange:this.handleChange,type:this.props.field.type,readOnly:!this.props.canUpdate,actions:t}),Object(ve.jsx)("div",{className:"secret-field-action",children:"password"===this.props.field.type&&this.props.canUpdate&&Object(ve.jsxs)(Qe,{id:"password-generation-options",pullRight:!0,children:[Object(ve.jsx)(Qe.Toggle,{children:Object(ve.jsx)(xe,{id:"generate",size:"small"})}),Object(ve.jsxs)(Qe.Menu,{children:[Object(ve.jsx)(Qe.MenuItem,{onSelect:this.onGenerate,children:Object(ve.jsx)(be.a,{id:"Generate strong"})}),Object(ve.jsx)(Qe.MenuItem,{onSelect:this.onGenerateAlphanum,children:Object(ve.jsx)(be.a,{id:"Generate alphanumeric"})}),Object(ve.jsx)(Qe.MenuItem,{onSelect:this.onGeneratePronounceable,children:Object(ve.jsx)(be.a,{id:"Generate pronounceable"})})]})]})})]})}}]),n}(l.Component),Pn=Object(pt.c)(Tn),An=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this;return!!this.props.fields&&Object(ve.jsx)("div",{className:"secret-fields",children:this.props.fields.map((function(t){return Object(ve.jsx)(Pn,{field:t,onChange:e.props.onChange,isNew:e.props.isNew,canUpdate:e.props.canUpdate},t.id)}))})}}]),n}(l.Component),In=An,Ln=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return this.props.data?Object(ve.jsx)("div",{className:"secret-edit",children:Object(ve.jsx)(In,{fields:this.props.data.fields,onChange:this.props.canUpdate?this.props.actions.changeField:function(){},canUpdate:this.props.canUpdate})}):Object(ve.jsx)("pre",{children:"Loading..."})}}]),n}(l.Component),Mn=Object(g.b)((function(e,t){return{data:t.data||e.EditSecretUI.data}}),(function(e){return{actions:Object(ht.bindActionCreators)(a,e)}}))(Ln),Rn=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleSubmit=function(){return r.props.onSubmit(r.state.title)},r.handleKeyDown=function(e){var t=e.key,n=e.target;"Enter"===t&&n.blur()},r.handleChange=function(e){var t=e.target;r.setState({title:t.value})},r.state={title:e.title},r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.canUpdate,n=e.isUpdating,r=this.state.title;return Object(ve.jsx)("input",{className:"secret-editable-title",type:"text",value:r,onBlur:this.handleSubmit,onKeyDown:this.handleKeyDown,onChange:this.handleChange,readOnly:!t||n,size:r.length+1})}}]),n}(l.Component),Dn=function(e){var t=e.icon,n=e.title,r=e.canEditTitle,s=e.isUpdating,a=e.onEditTitle;return Object(ve.jsxs)("div",{children:[Object(ve.jsx)(xe,{id:t,size:"small"}),Object(ve.jsx)(Rn,{title:n,canUpdate:r,isUpdating:s,onSubmit:function(e){e!==n&&a(e)}})]})},En=function(e){var t=e.side,n=e.disabled,r=e.onClick;return Object(ve.jsx)("div",{className:"secret-history-button",children:Object(ve.jsx)(Ue,{title:t,buttonStyle:"icon",disabled:n,onClick:r,children:Object(ve.jsx)(xe,{id:t})})})},zn=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.historyDepth,n=e.historyCount,r=e.modifiedAt,s=e.isLatest,a=e.isOldest,i=e.data,o=this.props.actions,c=o.historyShowOlder,l=o.historyShowNewer,d=s?"#1abc9c":"#afafaf";return Object(ve.jsxs)("div",{className:"secret-history",children:[Object(ve.jsxs)("div",{className:"secret-history-header",style:{backgroundColor:d,borderColor:d},children:[Object(ve.jsxs)("div",{className:"secret-history-navigation",children:[Object(ve.jsx)(En,{disabled:t>=n-1,side:"previous",onClick:c}),Object(ve.jsx)(En,{disabled:t<=0,side:"next",onClick:l})]}),Object(ve.jsxs)("span",{style:{color:"white",fontWeight:"600"},title:tt()(r).format("MMM Do, YYYY HH:mm"),children:[s&&Object(ve.jsx)(be.a,{id:"latest"}),a&&Object(ve.jsx)(be.a,{id:"oldest"})," ",tt()(r).fromNow()]})]}),Object(ve.jsx)("div",{className:"secret-history-fields",children:Object(ve.jsx)(Mn,{isUpdating:!1,canUpdate:!1,data:i})})]})}}]),n}(l.Component),Bn=Object(g.b)((function(e){var t,n,r=e.ShowSecretUI,s=r.secret,a=r.historyDepth;return{data:null===s||void 0===s||null===(t=s.history[a])||void 0===t?void 0:t.secret,modifiedAt:null===s||void 0===s||null===(n=s.history[a])||void 0===n?void 0:n.lastModifiedAt,historyCount:null===s||void 0===s?void 0:s.history.length,historyDepth:a,isLatest:0===a,isOldest:a+1>=(null===s||void 0===s?void 0:s.history.length)}}),(function(e){return{actions:Object(ht.bindActionCreators)(s,e)}}))(zn),_n=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(p.a)(this,n);for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).handleClick=function(){Fn()(e.select.getValue(),{debug:!0})},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this;if(!this.props.data)return Object(ve.jsx)("pre",{children:"Loading..."});var t=this.props.data.fields.reverse().map((function(e){return[e.content,tt()(e.date).format("dddd DD MMMM YYYY")]}));return Object(ve.jsx)("div",{className:"secret-edit",children:Object(ve.jsxs)("div",{className:"secret-field",children:[Object(ve.jsx)(Ee,{label:"Passwords",ref:function(t){e.select=t},options:t}),Object(ve.jsx)(Ue,{onClick:this.handleClick,children:"Copy"})]})})}}]),n}(l.Component),Gn=Object(g.b)((function(e){return{data:e.EditSecretUI.data}}))(_n),Hn=["emerland","nephritis","belize-hole","wisteria","midnight-blue","sun-flower","pumpkin","pomegranate","silver","asbestos"];function Yn(e){var t=e.split(" ");return t.length>1?"".concat(t[0][0]).concat(t[1][0]).toUpperCase():e.substring(0,2).toUpperCase()}function Vn(e){var t=e.user,n=e.size,r=function(e){var t=e.split("").reduce((function(e,t){return e+t.charCodeAt()}),0);return Hn[t%Hn.length]}(t.username),s=ge()("user-avatar","user-avatar--color-".concat(r),"user-avatar--size-".concat(n));return Object(ve.jsx)("div",{className:s,title:t.username,children:Yn(t.username)})}Vn.defaultProps={size:"base"};var Wn=Vn;var Qn=function(e){var t=e.user,n=e.disabled,r=e.disabledReason,s=e.onChangeUserRights,a=e.onRemoveUserRights,i=e.intl;return Object(ve.jsxs)("div",{className:"secret-users-list-item",children:[Object(ve.jsxs)("div",{className:"secret-users-list-item-infos",children:[Object(ve.jsx)(Wn,{user:t,size:"large"}),t.username]}),Object(ve.jsxs)("div",{className:"secret-users-list-item-actions",children:[Object(ve.jsx)(Ee,{value:t.rights,options:xt.map((function(e){return[e,i.formatMessage({id:St(e)})]})),size:"small",disabled:n,title:r,onChange:function(e){var n=e.value;return s(t,n)}}),Object(ve.jsx)(Ue,{buttonStyle:"icon",onClick:function(){return a(t)},disabled:n,title:r,size:"small",iconOnly:!0,children:Object(ve.jsx)(xe,{id:"close"})})]})]})},qn=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(j.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(j.a)(r)),r.state={user:new Ut},r}return Object(b.a)(n,[{key:"handleChange",value:function(e){var t=e.name,n=e.value;this.setState({user:this.state.user.merge(Object(Oe.a)({},t,n))})}},{key:"handleSubmit",value:function(){var e=this,t=this.props.secret,n=this.state.user,r=[this.props.intl.formatMessage({id:"read access"}),this.props.intl.formatMessage({id:"read and write access"}),this.props.intl.formatMessage({id:"read, write and share access"})][n.rights],s=n.username,a=t.title;Ze({title:this.props.intl.formatMessage({id:"Are you sure?"}),text:Object(ve.jsxs)("span",{children:[this.props.intl.formatMessage({id:"shareWarning"}),"\xa0",Object(ve.jsx)("b",{children:r}),"\xa0",this.props.intl.formatMessage({id:"to"}),"\xa0",Object(ve.jsx)("b",{children:s}),"\xa0",this.props.intl.formatMessage({id:"on"}),"\xa0",Object(ve.jsx)("b",{children:a}),"."]}),acceptLabel:this.props.intl.formatMessage({id:"Share the secret"}),cancelLabel:this.props.intl.formatMessage({id:"Cancel"}),onAccept:function(){e.props.dispatch(Xt({secret:e.props.secret,user:e.state.user,rights:e.state.user.rights})),e.setState({user:new Ut})},onCancel:function(){return{}}})}},{key:"render",value:function(){var e=this;return Object(ve.jsxs)("div",{className:"secret-users-list-new",children:[Object(ve.jsx)(Ke,{name:"username",placeholder:"".concat(this.props.intl.formatMessage({id:"login"}),"..."),value:this.state.user.username,size:"small",onChange:this.handleChange,autoCompleteFromList:this.props.knownFriendList,error:this.props.errors.username}),Object(ve.jsx)(Ee,{name:"rights",value:this.state.user.rights,size:"small",onChange:this.handleChange,options:xt.map((function(t){return[t,e.props.intl.formatMessage({id:St(t)})]}))}),Object(ve.jsx)(Ue,{buttonStyle:"icon",onClick:this.handleSubmit,disabled:!this.state.user.isValid(),size:"small",iconOnly:!0,children:Object(ve.jsx)(xe,{id:"add"})})]})}}]),n}(l.Component),Kn=Object(g.b)((function(e){return{knownFriendList:e.Metadata.knownFriendList}}))(Object(pt.c)(qn));var Jn=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onChangeUserRights=r.onChangeUserRights.bind(Object(j.a)(r)),r.onRemoveUserRights=r.onRemoveUserRights.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"onChangeUserRights",value:function(e,t){this.props.dispatch(Zt({secret:this.props.secret,user:e,rights:t}))}},{key:"onRemoveUserRights",value:function(e){this.props.dispatch(en({secret:this.props.secret,user:e}))}},{key:"render",value:function(){var e=this,t=this.props.currentUser,n=this.props.secret.canBeSharedBy(t)&&this.props.isOnline;return Object(ve.jsxs)("div",{className:"secret-users",children:[Object(ve.jsx)("div",{className:"secret-users-list",children:this.props.secret.users.map((function(r){return Object(ve.jsx)(Qn,{user:r,disabled:!n||t.username===r.id||e.props.isUpdating,disabledReason:(s=!n,a=t.username===r.id,i=e.props.intl,s?i.formatMessage({id:"You don't have the permission to share this secret"}):a?i.formatMessage({id:"You can't modify or remove yourself"}):null),onChangeUserRights:e.onChangeUserRights,onRemoveUserRights:e.onRemoveUserRights,intl:e.props.intl},r.id);var s,a,i}))}),n&&Object(ve.jsx)(Kn,{secret:this.props.secret,errors:this.props.errors})]})}}]),n}(l.Component),$n=Object(g.b)((function(e){var t=e.AppUI;return{currentUser:t.currentUser,isOnline:t.online}}))(Object(pt.c)(Jn));function Xn(e){var t=e.type,n=e.children,r=ge()("flash","flash--type-".concat(t));return Object(ve.jsxs)("div",{className:r,children:[Object(ve.jsx)("div",{className:"flash-icon",children:Object(ve.jsx)(xe,{id:t,size:"small"})}),Object(ve.jsx)("div",{className:"flash-content",children:n})]})}Xn.defaultProps={type:"info"};var Zn,er=Xn,tr=n(231),nr=n.n(tr),rr=n(232),sr=function(e){return Object(ve.jsx)(nr.a,Object(v.a)(Object(v.a)({className:"tabs",animation:!1},e),{},{children:e.children}))},ar=n.n(rr).a,ir=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleChangeTab=r.handleChangeTab.bind(Object(j.a)(r)),r.handleClick=r.handleClick.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"handleChangeTab",value:function(e){this.props.showSecretActions.changeTab({tab:e})}},{key:"handleClick",value:function(){this.props.metadataActions.updateSecret({secret:this.props.secret,data:this.props.data})}},{key:"render",value:function(){var e,t,n=this;if(!this.props.secret)return!1;var r=this.props.currentUser.username,s=this.props.secret.users.filter((function(e){return e.id!==r})),a=this.props.secret.canBeUpdatedBy(this.props.currentUser)&&(this.props.isOnline||0===s.length);return Object(ve.jsxs)(Ce,{show:this.props.shown,closeOnBackdropClick:!this.props.isEditing,onClose:this.props.showSecretActions.hideModal,children:[Object(ve.jsx)(Ce.Header,{children:Object(ve.jsx)(Dn,{icon:this.props.secret.getIcon(),title:this.props.secret.title,canEditTitle:a,isUpdating:this.props.isUpdating,onEditTitle:function(e){setTimeout((function(){n.props.metadataActions.renameSecret({secret:n.props.secret,newTitle:e})}))}})}),Object(ve.jsxs)(Ce.Body,{children:["windows"===this.props.secret.type&&Object(ve.jsx)(er,{type:"info",children:"This secret is used for your Windows domain authentication. It cannot be deleted."}),Object(ve.jsxs)(sr,{id:"secret-tabs",activeKey:this.props.tab,onSelect:this.handleChangeTab,children:["folder"!==this.props.secret.type&&Object(ve.jsx)(ar,{eventKey:"details",title:this.props.intl.formatMessage({id:"Details"}),children:"windows"===this.props.secret.type?Object(ve.jsx)(Gn,{isUpdating:this.props.isUpdating}):Object(ve.jsx)(Mn,{isUpdating:this.props.isUpdating,canUpdate:a,data:this.props.secret.fields})}),"windows"!==this.props.secret.type&&Object(ve.jsx)(ar,{eventKey:"access",title:this.props.intl.formatMessage({id:"Who has access"}),children:Object(ve.jsx)($n,{isUpdating:this.props.isUpdating,errors:this.props.errors,secret:this.props.secret})}),(null===(e=this.props.secret)||void 0===e||null===(t=e.history)||void 0===t?void 0:t.length)>1&&Object(ve.jsx)(ar,{eventKey:"history",title:this.props.intl.formatMessage({id:"History"}),children:Object(ve.jsx)(Bn,{})})]})]}),Object(ve.jsxs)(Ce.Footer,{children:[Object(ve.jsx)(Ue,{type:"reset",buttonStyle:"default",onClick:this.props.showSecretActions.hideModal,disabled:this.props.isUpdating,children:Object(ve.jsx)(be.a,{id:this.props.isEditing?"Cancel":"Close"})}),this.props.isEditing&&Object(ve.jsx)(Ue,{type:"submit",buttonStyle:"primary",onClick:this.handleClick,disabled:this.props.isUpdating,children:Object(ve.jsx)(be.a,{id:"Save"})})]})]})}}]),n}(l.Component),or=Object(g.b)((function(e){var t=e.ShowSecretUI,n=t.secret,r=t.errors,s=t.tab,a=t.isUpdating,i=e.EditSecretUI,o=i.isEditing,c=i.data,l=e.AppUI;return{secret:n,shown:!!n,errors:r,tab:s,isUpdating:a,isEditing:o,data:c,currentUser:l.currentUser,isOnline:l.online}}),(function(e){return{showSecretActions:Object(ht.bindActionCreators)(s,e),metadataActions:Object(ht.bindActionCreators)(r,e)}}))(Object(pt.c)(ir)),cr=n(114),lr=n(233),dr=n.n(lr),ur=n(92),hr=n.n(ur),pr=n(53),br=n(59),jr=n(165),fr=n(27),mr=n(488),gr=(n(478),function(){return localStorage.getItem("defaultLanguage")||Ie()}),Or=function(){return tt.a.locale(gr())};Or();var vr,yr=Object(fr.c)(),wr=Object(mr.a)({locale:gr(),messages:Ae(gr())},yr),xr=function(){return{shown:!1,folder:null,isFolder:!1,title:"",data:wt.createWithDefaultFields(wt.DEFAULT_FIELDS).getRaw()}},Sr=Object(T.b)({name:"NewSecretUI",initialState:xr(),reducers:{showModal:function(e,t){var n,r,s=t.payload,a=s.folder,i=s.isFolder;e.shown=!0,e.title=wr.formatMessage({id:"Untitled ".concat(i?"folder":"secret")}),e.folder=a,e.isFolder=i;var o=e.data.fields.findIndex((function(e){return"login"===e.label})),c=e.data.fields.findIndex((function(e){return"password"===e.label}));e.data.fields[o].content=null!==(n=null===(r=F.currentUser.options)||void 0===r?void 0:r.defaultUsername)&&void 0!==n?n:"",e.data.fields[c].content=y.Utils.PasswordGenerator.generatePassword()},hideModal:function(){return xr()},changeTitle:function(e,t){var n=t.payload.value;e.title=n},changeField:function(e,t){var n=t.payload,r=n.field,s=n.value,a=e.data.fields.findIndex((function(e){return e.id===r.id}));e.data.fields[a].content=s}},extraReducers:(Zn={},Object(Oe.a)(Zn,Y,xr),Object(Oe.a)(Zn,W,xr),Zn)}),Cr=Sr.actions,kr=Cr.showModal,Ur=Cr.hideModal,Nr=Cr.changeTitle,Fr=Cr.changeField,Tr=Sr.reducer,Pr=function(){return{options:{},errors:{},showQRCode:!1,showShortLogin:!1,showRescueCodes:!1,newPass:{shown:!1,newPass1:"",newPass2:"",error:"",loading:!1,status:"initial"},rescueCodes:[],loading:!1}},Ar=Object(T.b)({name:"Options",initialState:{options:{},errors:{},showQRCode:!1,showShortLogin:!1,showRescueCodes:!1,newPass:{shown:!1,newPass1:"",newPass2:"",error:"",loading:!1,status:"initial"},rescueCodes:[],loading:!1},reducers:{_activateTotp:function(e,t){e.loading=!0},_activateShortLogin:function(e,t){e.loading=!0},_toggleTotp:function(e,t){var n=t.payload.checked;e.showQRCode=n},_toggleShortLogin:function(e,t){var n=t.payload.checked;e.showShortLogin=n},activateTotpFailure:function(e,t){var n=t.payload.error;e.errors.totp=n,e.loading=!1},hideQRCode:function(e,t){e.showQRCode=!1,e.loading=!1,e.errors={}},hideShortLogin:function(e,t){e.showShortLogin=!1,e.loading=!1,e.errors={}},activateTotpSuccess:function(e,t){e.showQRCode=!1,e.loading=!1,e.errors={},e.options.totp=!0},deactivateTotpSuccess:function(e,t){e.options.totp=!1},deactivateShortLoginSuccess:function(e,t){var n=t.payload.shortLogin;e.options.shortLogin=n},activateShortLoginSuccess:function(e,t){var n=t.payload.shortLogin;e.showShortLogin=!1,e.loading=!1,e.errors={},e.options.shortLogin=n},changeDelaySuccess:function(e,t){var n=t.payload.timeToClose;e.options.timeToClose=n},changeDefaultUsernameSuccess:function(e,t){var n=t.payload.defaultUsername;e.options.defaultUsername=n},changeNewPass1:function(e,t){var n=t.payload;e.newPass.newPass1=n.value},changeNewPass2:function(e,t){var n=t.payload;e.newPass.newPass2=n.value},showChangePassword:function(e,t){e.newPass.newPass1="",e.newPass.newPass2="",e.newPass.error="",e.newPass.loading=!1,e.newPass.shown=!0},hideChangePassword:function(e,t){e.newPass.newPass1="",e.newPass.newPass2="",e.newPass.error="",e.newPass.loading=!1,e.newPass.shown=!1},_changePassword:function(e,t){e.newPass.loading=!0,e.newPass.error=""},changePasswordSuccess:function(e,t){e.newPass.newPass1="",e.newPass.newPass2="",e.newPass.error="",e.newPass.loading=!1,e.newPass.status="success"},changePasswordFailure:function(e,t){e.newPass.error="Password change failed",e.newPass.loading=!1,e.newPass.status="failure"},showRescueCodesSuccess:function(e,t){var n=t.payload.rescueCodes;e.rescueCodes=n,e.showRescueCodes=!0},hideRescueCodes:function(e,t){e.rescueCodes=[],e.showRescueCodes=!1}},extraReducers:(vr={},Object(Oe.a)(vr,X,(function(e,t){var n=t.payload.options;e.options=n})),Object(Oe.a)(vr,q,Pr),Object(Oe.a)(vr,W,Pr),vr)}),Ir=Ar.actions,Lr=Ir._activateTotp,Mr=Ir._activateShortLogin,Rr=Ir._toggleTotp,Dr=Ir._toggleShortLogin,Er=Ir.activateTotpFailure,zr=Ir.activateTotpSuccess,Br=Ir.hideQRCode,_r=Ir.hideShortLogin,Gr=Ir.deactivateTotpSuccess,Hr=Ir.deactivateShortLoginSuccess,Yr=Ir.activateShortLoginSuccess,Vr=Ir.changeDelaySuccess,Wr=Ir.changeDefaultUsernameSuccess,Qr=Ir.changeNewPass1,qr=Ir.changeNewPass2,Kr=Ir.showChangePassword,Jr=Ir.hideChangePassword,$r=Ir._changePassword,Xr=Ir.changePasswordSuccess,Zr=Ir.changePasswordFailure,es=Ir.showRescueCodesSuccess,ts=Ir.hideRescueCodes,ns=function(){return function(e,t){return F.deactivateTotp().then((function(){return e(Gr())})).catch((function(){}))}},rs=function(e){var t=e.seed,n=e.token;return function(e,r){return e(Lr()),F.api.testTotp(t.b32,n).then((function(){return F.activateTotp(t)})).then((function(){return e(zr())})).catch((function(t){e(Er("Invalid couple"===t?{error:"Synchronisation error"}:{error:"An error occured"}))}))}},ss=function(e){var t=e.shortpass;return function(e,n){return e(Mr()),F.activateShortLogin(t,gt.a.v4()).then((function(){return e(Yr({shortLogin:F.canITryShortLogin()}))})).catch((function(){}))}},as=function(){return function(e,t){F.deactivateShortLogin().then((function(){return e(Hr({shortLogin:F.canITryShortLogin()}))})).catch((function(){}))}},is=function(e){var t=e.newPass;return function(e,n){e($r()),F.changePassword(t).then((function(){e(Xr())})).catch((function(){e(Zr())}))}},os=function(e){var t=e.checked;return function(e,n){return e(Rr({checked:t})),!!t||e(ns())}},cs=function(){return function(e,t){window.confirm("Be careful, this will replace your previously generated codes. Continue?")&&F.getRescueCodes().then((function(t){e(es({rescueCodes:t}))}))}},ls=function(e){var t=e.checked;return function(e,n){return e(Dr({checked:t})),!!t||e(as())}},ds=function(e){var t=e.checked;return function(e,n){return e(hs({timeToClose:t?30:0}))}},us=function(e){var t=e.defaultUsername;return function(e,n){return F.editOption("defaultUsername",t).then((function(){e(Wr({defaultUsername:t}))})).catch((function(){})),!0}},hs=function(e){var t=e.timeToClose;return function(e,n){return F.editOption("timeToClose",t).then((function(){e(Vr({timeToClose:t}))})).catch((function(){})),!0}},ps=Ar.reducer,bs=function(){function e(t,n){Object(p.a)(this,e),this.func=t,this.total=n,this.status=0}return Object(b.a)(e,[{key:"update",value:function(){this.status+=1,this.func({state:this.status,total:this.total})}}]),e}();function js(e,t){for(var n="",r={type:"default",fields:[{id:gt.a.v4(),type:"text",label:"login",content:""},{id:gt.a.v4(),type:"password",label:"password",content:""},{id:gt.a.v4(),type:"url",label:"url",content:""}]},s=e.querySelectorAll(":scope > String"),a=0;a<s.length;a+=1){var i=s[a].children[0].textContent,o=s[a].children[1].textContent;"title"===i.toLowerCase()?n=o:"password"===i.toLowerCase()?r.fields[1].content=o:"url"===i.toLowerCase()?r.fields[2].content=o:"username"===i.toLowerCase()?r.fields[0].content=o:Object(Re.isEmpty)(o)||r.fields.push({id:gt.a.v4(),type:"text",label:i,content:o})}var c="";return F.addSecret(n,r).then((function(e){return c=e,"undefined"!==typeof t?F.addSecretToFolder(c,t):Promise.resolve()}))}function fs(e,t){console.log("".concat(e,"/").concat(t))}function ms(e,t,n){var r;"undefined"===typeof n?r=[].slice.call(e.querySelectorAll(":scope > Entry")).reduce((function(e,r){return e.then((function(){return js(r,n).then((function(){t.update()}))}))}),Promise.resolve()):r=Promise.resolve();return r.then((function(){return[].slice.call(e.querySelectorAll(":scope > Group")).reduce((function(e,r){return e.then((function(){return function(e,t,n){var r="",s=e.getElementsByTagName("Name")[0].textContent;return F.addFolder(s).then((function(n){return r=n,[].slice.call(e.querySelectorAll(":scope > Entry")).reduce((function(e,n){return e.then((function(){return js(n,r).then((function(){t.update()}))}))}),Promise.resolve())})).then((function(){return"undefined"!==typeof n?F.addSecretToFolder(r,n):Promise.resolve()})).then((function(){return ms(e,t,r)}))}(r,t,n)}))}),Promise.resolve())}))}function gs(e){for(var t=e.querySelectorAll(":scope > Entry").length,n=e.querySelectorAll(":scope > Group"),r=0;r<n.length;r+=1)t+=gs(n[r]);return t}var Os={parse:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fs,r=new DOMParser,s=r.parseFromString(e,"application/xml"),a=s.getElementsByTagName("Root")[0].children[0],i=new bs(n,gs(a));return ms(a,i)},detect:function(e){var t=new DOMParser,n=!1;try{n=1===t.parseFromString(e,"application/xml").getElementsByTagName("KeePassFile").length}catch(r){n=!1}return n},mandatoryFields:{}};function vs(e,t){console.log("".concat(e,"/").concat(t))}var ys={parse:function(e,t){t.username;var n=t.password,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vs;return F.importDb(n.value,e,r)},detect:function(e){var t=!1;try{var n=JSON.parse(e);t="users"in n&&"secrets"in n}catch(r){t=!1}return t},mandatoryFields:{password:{type:"password",name:"password",value:""}}},ws={keepass:Os,secretin:ys},xs=void 0,Ss=function(){return{importType:"",importing:!1,importStatus:0,importTotal:0,success:!1,file:"",error:"",mandatoryFields:{}}},Cs=Object(T.b)({name:"Import",initialState:{importType:"",importing:!1,importStatus:0,importTotal:0,success:!1,file:"",error:"",mandatoryFields:{}},reducers:{showModal:function(e,t){var n=t.payload,r=n.secret,s=n.tab;xs.state.secret=r,xs.state.tab=s||"details",xs.state.errors={}},_importSecrets:function(e,t){e.importing=!0,e.success=!1,e.error=""},detectTypeFailure:function(e,t){var n=t.payload.error;e.error=n,e.importType="",e.mandatoryFields={}},detectTypeSuccess:function(e,t){var n=t.payload,r=n.file,s=n.importType,a=n.mandatoryFields;e.importType=s,e.error="",e.file=r,e.mandatoryFields=a},importSecretsProgress:function(e,t){var n=t.payload,r=n.importStatus,s=n.importTotal;e.error="",e.importStatus=r,e.importTotal=s},importSecretsSuccess:function(e,t){e.importing=!1,e.success=!0,e.importType="",e.error="",e.importStatus=0,e.importTotal=0,e.mandatoryFields={}},importSecretsFailure:function(e,t){var n=t.payload.error;e.importing=!1,e.success=!1,e.importType="",e.error=n,e.mandatoryFields={}},defaultStore:function(e,t){({importType:"",importing:!1,importStatus:0,importTotal:0,success:!1,file:"",error:"",mandatoryFields:{}})},changeMandatoryField:function(e,t){var n=t.payload,r=n.field,s=n.value;e.mandatoryFields[r.name].value=s}},extraReducers:Object(Oe.a)({},W,Ss)}),ks=Cs.actions,Us=ks.showModal,Ns=ks._importSecrets,Fs=ks.detectTypeFailure,Ts=ks.detectTypeSuccess,Ps=ks.importSecretsProgress,As=ks.importSecretsSuccess,Is=ks.importSecretsFailure,Ls=ks.defaultStore,Ms=ks.changeMandatoryField,Rs=function(e){var t=e.file;return function(e,n){var r=new FileReader;return r.readAsText(t),r.onload=function(t){var n=t.target.result,r=Object(Re.findKey)(ws,(function(e){return e.detect(n)}));if("undefined"!==typeof r){var s=ws[r].mandatoryFields;e(Ts({file:n,importType:r,mandatoryFields:s}))}else e(Fs({error:"Invalid type"}))},r}},Ds=function(e){var t=e.file,n=e.type,r=e.mandatoryFields;return function(e,s){e(Ns()),ws[n].parse(t,r,(function(t){var n=t.state,r=t.total;return e(Ps({importStatus:n,importTotal:r}))})).then((function(){e(As())})).catch((function(t){e(Is({error:t}))}))}},Es=Cs.reducer,zs=Object(T.a)({reducer:{AppUI:ie,EditSecretUI:Un,Metadata:rn,NewSecretUI:Tr,ShowSecretUI:yn,Options:ps,Import:Es},middleware:function(e){return e({serializableCheck:{ignoredActions:["AppUI/onLoginUserProgress","AppUI/loginUserSuccess","Metadata/addSecretToFolderSuccess"],ignoredPaths:["AppUI.currentUser","Metadata.metadata"]}})}}),Bs=n(235),_s=n.n(Bs);function Gs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/secrets";return _s()(t,e.join("/"),"/")}function Hs(e){var t=e.users,n=e.size,r=ge()("user-avatars","user-avatars--size-".concat(n));return Object(ve.jsx)("div",{className:r,children:t.map((function(e){return Object(ve.jsx)(Wn,{user:e,size:n},e.id)}))})}Hs.defaultProps={size:"base"};var Ys=Hs,Vs=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(p.a)(this,n);for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).handleShow=function(){var t=e.props.secret;e.props.dispatch(vn({secret:t,tab:"folder"===t.type?"access":"details"}))},e.handleShare=function(){var t=e.props.secret;e.props.dispatch(vn({secret:t,tab:"access"}))},e.handleMoveToParent=function(){var t=e.props,n=t.parentFolderId,r=t.secret;e.props.dispatch(nn({secret:r,currentFolderId:n}))},e.handleDelete=function(){var t=e.props.secret;return Ze({title:Object(ve.jsxs)("span",{children:["Delete ",Object(ve.jsx)("b",{children:t.title}),"?"]}),text:Object(ve.jsxs)("span",{children:["You are about to ",Object(ve.jsx)("b",{children:"delete"})," the secret ",Object(ve.jsx)("b",{children:t.title}),". This action is definitive and can't be recovered."]}),acceptLabel:"Delete the secret",cancelLabel:"Cancel",onAccept:function(){return e.props.dispatch($t({secret:t}))},onCancel:function(){return{}}}),!0},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.parentFolderId,n=e.secret,r=e.currentUser,s=e.folder,a=n.canBeSharedBy(r);return a||"folder"!==n.type?Object(ve.jsxs)(Qe,{id:"secret-action",pullRight:!0,children:[Object(ve.jsx)(Qe.Toggle,{children:Object(ve.jsx)(xe,{id:"more-vert",size:"small"})}),Object(ve.jsxs)(Qe.Menu,{children:["folder"!==n.type&&Object(ve.jsx)(Qe.MenuItem,{onSelect:this.handleShow,children:"Show"}),a&&Object(ve.jsx)(Qe.MenuItem,{onSelect:this.handleShare,disabled:!this.props.isOnline,children:"Share"}),(t||n.canBeDeleted())&&Object(ve.jsxs)("div",{children:[Object(ve.jsx)(Qe.MenuItem,{divider:!0}),t&&Object(ve.jsxs)(Qe.MenuItem,{onSelect:this.handleMoveToParent,children:["Remove from\xa0",Object(ve.jsx)("b",{children:s.title})]}),n.canBeDeleted()&&Object(ve.jsx)(Qe.MenuItem,{onSelect:this.handleDelete,disabled:!this.props.isOnline,children:"Delete"})]})]})]}):null}}]),n}(l.Component),Ws=Object(g.b)((function(e,t){var n=e.AppUI;return{isOnline:n.online,currentUser:n.currentUser,folder:e.Metadata.metadata.find((function(e){return e.id===t.parentFolderId}))}}))(Vs);var Qs={drop:function(e,t){var n=e.secret,r=t.getItem().secret;zs.dispatch(tn({secret:r,folder:n}))},canDrop:function(e,t){var n=e.secret,r=zs.getState().AppUI.currentUser.username,s=t.getItem().secret;return 0!==s.users.find((function(e){return e.id===r})).rights&&"folder"===n.type&&n.id!==s.id&&0!==n.users.find((function(e){return e.id===r})).rights}};var qs=new pr.DragSource("SecretListItem",{beginDrag:function(e){return{secret:e.secret}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.secret,n=e.folders,r=e.isDragging,s=e.canDrop,a=e.isOver,i=e.connectDragSource,o=e.connectDropTarget,c=Object(g.d)((function(e){return e.AppUI.currentUser})),l=Object(g.d)((function(e){return e.AppUI.online})),d=t.users.find((function(e){return e.id===c.username})).rights,u=t.users.filter((function(e){return e.id!==c.username})),h=ge()("secret-list-item",{"secret-list-item--is-dragging":r,"secret-list-item--is-over":a,"secret-list-item--can-drop":s,"secret-list-item--cant-drop":!s}),p=Object(ve.jsx)("div",{children:Object(ve.jsxs)(O.b,{to:Gs([].concat(Object(br.a)(n),[t.id])),children:[Object(ve.jsx)(xe,{id:t.getIcon(),size:"base"}),Object(ve.jsx)("span",{className:"text",title:t.title,children:t.title})]})});return o(Object(ve.jsxs)("div",{className:h,children:[Object(ve.jsx)("div",{className:"secret-list-item-column secret-list-item-column--title",children:d>0&&(l||0===u.length)?i(p):p}),Object(ve.jsxs)("div",{className:"secret-list-item-column secret-list-item-column--last-modified",children:[t.lastModifiedAt.fromNow()," - ",Object(ve.jsx)("span",{className:"muted",children:t.lastModifiedBy})]}),Object(ve.jsx)("div",{className:"secret-list-item-column secret-list-item-column--shared-with",children:u.length>0?Object(ve.jsx)(Ys,{users:u}):"\u2013\u2013"}),Object(ve.jsx)("div",{className:"secret-list-item-column secret-list-item-column--actions",children:Object(ve.jsx)(Ws,{parentFolderId:n[n.length-1],secret:t})})]}))})),Ks=new pr.DropTarget("SecretListItem",Qs,(function(e,t){return{connectDropTarget:e.dropTarget(),canDrop:t.canDrop(),isOver:t.isOver()}}))(qs);var Js=new pr.DragSource("SecretListItem",{beginDrag:function(e){return{secret:e.secret}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t,n=e.secret,r=e.parentFolderId,s=e.isDragging,a=e.connectDragSource,i=Object(g.d)((function(e){return e.AppUI.currentUser})),o=Object(g.d)((function(e){return e.AppUI.online})),c=Object(g.c)(),l=n.users.filter((function(e){return e.id!==i.username})),d=(null===(t=n.users.find((function(e){return e.id===i.username})))||void 0===t?void 0:t.rights)||0,u=ge()("secret-list-item",{"secret-list-item--is-dragging":s}),h=Object(ve.jsx)("div",{children:Object(ve.jsxs)("a",{onClick:function(){return c(vn({secret:n}))},tabIndex:"-1",children:[Object(ve.jsx)(xe,{id:n.getIcon(),size:"base"}),Object(ve.jsx)("span",{className:"text",title:n.title,children:n.title})]})});return Object(ve.jsxs)("div",{className:u,children:[Object(ve.jsx)("div",{className:"secret-list-item-column secret-list-item-column--title",children:d>0&&(o||0===l.length)?a(h):h}),Object(ve.jsxs)("div",{className:"secret-list-item-column secret-list-item-column--last-modified",children:[n.lastModifiedAt.fromNow()," - ",Object(ve.jsx)("span",{className:"muted",children:n.lastModifiedBy})]}),Object(ve.jsx)("div",{className:"secret-list-item-column secret-list-item-column--shared-with",children:l.length>0?Object(ve.jsx)(Ys,{users:l}):"\u2013\u2013"}),Object(ve.jsx)("div",{className:"secret-list-item-column secret-list-item-column--actions",children:Object(ve.jsx)(Ws,{parentFolderId:r,secret:n})})]})}));var $s=function(e){var t=e.secret,n=e.folders;return"folder"===t.type?Object(ve.jsx)(Ks,{secret:t,folders:n}):Object(ve.jsx)(Js,{parentFolderId:n[n.length-1],secret:t})};function Xs(e){var t=e.icon,n=e.title,r=e.link;return Object(ve.jsx)("div",{className:"breadcrumb-item",children:Object(ve.jsxs)(O.c,{to:r,className:"breadcrumb-link",activeClassName:"breadcrumb-link--active",exact:!0,children:[Object(ve.jsx)(xe,{id:t,size:"base"}),n]})})}Xs.defaultProps={icon:"home",title:"Home",link:"/secrets/"};var Zs=Xs;function ea(e){var t=e.folders,n=e.withTitle,r=Object(g.d)((function(e){return e.AppUI.currentUser})),s=Object(g.d)((function(e){return e.Metadata.metadata})),a=t.reduce((function(e,t){return[].concat(Object(br.a)(e),[{folderId:t,link:Gs([t],e[e.length-1]?e[e.length-1].link:void 0)}])}),[]).reduce((function(e,t,n){var r=t.folderId,a=t.link,i=null===s||void 0===s?void 0:s.find((function(e){return e.id===r}));return i?[].concat(Object(br.a)(e),[Object(ve.jsx)("div",{className:"breadcrumb-item",children:Object(ve.jsx)(O.c,{to:a,className:"breadcrumb-link",activeClassName:"breadcrumb-link--active",exact:!0,children:i.title})},n),Object(ve.jsx)(xe,{id:"chevron-right",className:"breadcrumb-item-separator"},"".concat(n,"-sep"))]):e}),[]);return n&&(a.unshift(Object(ve.jsx)(xe,{id:"chevron-right",className:"breadcrumb-item-separator"},"home-sep")),a.unshift(Object(ve.jsx)(Zs,{title:r.username,icon:"home",link:"/secrets/"},"home"))),Object(ve.jsx)("div",{className:"breadcrumb",children:a})}ea.defaultProps={folders:[],withTitle:!0};var ta=ea;var na=function(e){var t=e.folder;return t.root?null:Object(ve.jsx)("div",{className:"secret-list-folder",children:Object(ve.jsx)("div",{colSpan:"4",className:"secret-list-folder-info",children:Object(ve.jsx)(ta,{folders:t.breadcrumb,withTitle:!1})})})},ra=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.allFolders,r=t.currentUser,s=ge()("secret-list-content-table",{"secret-list-content-table--is-dragging":this.props.isDragging}),a=new RegExp(this.props.searchQuery.split("").map((function(e){return Object(Re.escapeRegExp)(e)})).join(".*"),"i"),i=this.props.secrets.filter((function(e){return a.test(e.title)})),o={},c=[],l=function(e,t){return e.find((function(e){return e.id===t}))};if(this.props.filtered){i.forEach((function(e){var t="ROOT",s=l(e.users,r.username);s&&(t=Object.keys(s.folders)[0]),"undefined"===typeof t&&(t="ROOT"),Object(Re.set)(o,"".concat(t,".secrets.").concat(e.id),e),"ROOT"===t?(o[t].name="",o[t].root=!0):function(){for(var e=!1,s=[],a=[],i=t;!e;){var c=n.find((function(e){return e.id===i}));a.unshift(c.title),e=Object.keys(l(c.users,r.username).folders).includes("ROOT"),s.unshift(i),i=Object.keys(l(c.users,r.username).folders)[0]}o[t].name=a.join("/"),o[t].breadcrumb=s}()}));var d=Object.entries(o).map((function(e){var t=Object(he.a)(e,2),n=t[0],r=t[1];return Object(v.a)(Object(v.a)({},r),{},{id:n})}));d.sort((function(e,t){return e.name.toLowerCase().localeCompare(t.name.toLowerCase())})),d.sort((function(e,t){return e.root})),c=d.map((function(e){var t=Object.values(e.secrets);return t.sort((function(e,t){return null===e.title?1:null===t.title?-1:e.title.toLowerCase().localeCompare(t.title.toLowerCase())})),[{rowType:"header",rowData:e}].concat(Object(br.a)(t.map((function(e){return{rowType:"row",rowData:e}}))))})).flat()}else i.sort((function(e,t){return null===e.title?1:null===t.title?-1:e.title.toLowerCase().localeCompare(t.title.toLowerCase())}));var u=function(e){var t=e.index,n=e.key,r=e.style,s=c[t],a=s.rowType,i=s.rowData;return"header"===a?Object(ve.jsx)("div",{style:r,children:Object(ve.jsx)(na,{folder:i},i.id)},n):Object(ve.jsx)("div",{style:r,children:Object(ve.jsx)(Js,{secret:i},i.id)},n)},h=function(t){var n=t.index,r=t.key,s=t.style,a=i[n];return Object(ve.jsx)("div",{style:s,children:Object(ve.jsx)($s,{secret:a,folders:e.props.folders},a.id)},r)},p=function(t){var n=t.index;return e.props.filtered&&"header"===c[n].rowType?c[n].rowData.root?0:75:50};return Object(ve.jsx)("div",{className:s,children:Object(ve.jsx)(jr.a,{children:function(t){var n=t.width,r=t.height;return Object(ve.jsx)(jr.b,{width:n,height:r,rowHeight:p,rowRenderer:e.props.filtered?u:h,rowCount:e.props.filtered?c.length:i.length})}})})}}]),n}(l.Component),sa=Object(g.b)((function(e){return{currentUser:e.AppUI.currentUser,allFolders:Object.values(e.Metadata.metadata).filter((function(e){return"folder"===e.type}))||[]}}))(ra);var aa=function(){var e=Object(g.c)();return Object(ve.jsx)("div",{className:"secret-list-refresh",children:Object(ve.jsx)(Ue,{title:"Refresh secret list",buttonStyle:"icon",onClick:function(){return e(Qt())},children:Object(ve.jsx)(xe,{id:"refresh"})})})},ia=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onSubmit=r.onSubmit.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"onSubmit",value:function(){var e=this.props,t=e.folder,n=e.isFolder,r=e.title,s=e.data;this.props.metadataActions.createSecret({folder:null===t||void 0===t?void 0:t.id,isFolder:n,title:r,data:s})}},{key:"render",value:function(){var e=this.props.isFolder;return Object(ve.jsxs)(Ce,{show:this.props.shown,onClose:this.props.newSecretActions.hideModal,children:[Object(ve.jsx)(Ce.Header,{title:e?this.props.intl.formatMessage({id:"create folder title"}):this.props.intl.formatMessage({id:"create secret title"})}),Object(ve.jsx)(Ce.Body,{children:Object(ve.jsxs)(Ge,{id:"new-secret",onSubmit:this.onSubmit,disabled:!1,children:[Object(ve.jsx)(Ke,{label:e?this.props.intl.formatMessage({id:"Folder title"}):this.props.intl.formatMessage({id:"Secret title"}),name:"title",value:this.props.title,type:"text",onChange:this.props.newSecretActions.changeTitle,autoSelect:!0,required:!0}),!e&&Object(ve.jsx)(In,{fields:this.props.data.fields,onChange:this.props.newSecretActions.changeField,isNew:!0,canUpdate:!0})]})}),Object(ve.jsxs)(Ce.Footer,{children:[Object(ve.jsx)(Ue,{type:"reset",buttonStyle:"default",onClick:this.props.newSecretActions.hideModal,children:Object(ve.jsx)(be.a,{id:"Cancel"})}),Object(ve.jsx)(Ue,{type:"submit",onClick:this.onSubmit,disabled:this.props.isLoading,children:e?Object(ve.jsx)(be.a,{id:"add folder button"}):Object(ve.jsx)(be.a,{id:"add secret button"})})]})]})}}]),n}(l.Component),oa=Object(g.b)((function(e,t){return Object(v.a)(Object(v.a)({},e.NewSecretUI),{},{isLoading:e.AppUI.loading,folder:t.folder})}),(function(e){return{newSecretActions:Object(ht.bindActionCreators)(i,e),metadataActions:Object(ht.bindActionCreators)(r,e)}}))(Object(pt.c)(ia));var ca=function(e){var t=e.folder,n=e.showAddFolder,r=Object(g.d)((function(e){return e.AppUI.currentUser})),s=Object(g.c)(),a=null,i=!0;return t&&(a=t.id,i=t.canBeUpdatedBy(r)),Object(ve.jsxs)("div",{className:"secret-list-new",children:[Object(ve.jsx)(oa,{folder:t}),Object(ve.jsxs)(Ue,{title:"Add secret",buttonStyle:"primary",size:"small",disabled:!i,onClick:function(){return s(kr({folder:a,isFolder:!1}))},children:[Object(ve.jsx)(xe,{id:"add-secret",size:"small"}),Object(ve.jsx)(be.a,{id:"new secret"})]}),n&&Object(ve.jsxs)(Ue,{title:"Add folder",buttonStyle:"primary",size:"small",disabled:!i,onClick:function(){return s(kr({folder:a,isFolder:!0}))},children:[Object(ve.jsx)(xe,{id:"add-folder",size:"small"}),Object(ve.jsx)(be.a,{id:"new folder"})]})]})},la=n(164),da=n.n(la),ua=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onChange=r.onChange.bind(Object(j.a)(r)),r.focus=r.focus.bind(Object(j.a)(r)),r.blur=r.blur.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){da.a.bind("mod+f",this.focus)}},{key:"componentWillUnmount",value:function(){da.a.unbind("mod+f",this.focus)}},{key:"onChange",value:function(e){this.props.onChange(e.target.value)}},{key:"focus",value:function(e){this.searchInput!==document.activeElement&&(this.searchInput.focus(),e.preventDefault())}},{key:"blur",value:function(e){"Escape"===e.key&&""===e.target.value&&this.searchInput.blur()}},{key:"render",value:function(){var e=this;return Object(ve.jsx)("div",{className:"input input--type-search input--size-small",children:Object(ve.jsx)("input",{ref:function(t){e.searchInput=t},type:"search",placeholder:this.props.intl.formatMessage({id:"search"}),onChange:this.onChange,onKeyDown:this.blur})})}}]),n}(l.Component),ha=Object(pt.c)(ua),pa=U.DecryptMetadataStatus,ba=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={message:""},r}return Object(b.a)(n,[{key:"render",value:function(){if(!this.props.show)return null;var e=this.props,t=e.state,n=e.total,r="".concat(Math.round(t/n*100),"%"),s={width:r};return Object(ve.jsxs)("div",{className:"user-connect-progress",children:[Object(ve.jsx)("div",{className:"user-connect-progress-bar",style:s}),Object(ve.jsx)("div",{className:"user-connect-progress-text",children:this.state.message}),Object(ve.jsx)("div",{className:"user-connect-progress-title",children:r})]})}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.message;return{message:t instanceof pa?"Updating your secrets...":t}}}]),n}(l.Component),ja=Object(g.b)((function(e){if(!e.AppUI.status)return{show:!1};var t=e.AppUI.status;return{show:!0,message:t.message,state:t.state,total:t.total}}))(ba),fa=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onSearch=r.onSearch.bind(Object(j.a)(r)),r.state={searchQuery:e.searchQuery},r}return Object(b.a)(n,[{key:"onSearch",value:function(e){this.setState({searchQuery:e})}},{key:"render",value:function(){var e,t,n,r=!1;return this.props.showAll?(e="apps",t=Object(ve.jsx)(be.a,{id:"all"}),n="/secrets/all/",r=!0):this.props.showMine?(e="user",t=Object(ve.jsx)(be.a,{id:"my secrets"}),n="/secrets/mine/",r=!0):this.props.showShared&&(e="people",t=Object(ve.jsx)(be.a,{id:"shared secrets"}),n="/secrets/shared/",r=!0),Object(ve.jsxs)("div",{className:"page",children:[Object(ve.jsxs)("div",{className:"page-header",children:[r?Object(ve.jsx)("div",{className:"breadcrumb",children:Object(ve.jsx)(Zs,{icon:e,title:t,link:n})}):Object(ve.jsx)(ta,{folders:this.props.folders}),Object(ve.jsx)(aa,{}),Object(ve.jsx)(ha,{onChange:this.onSearch})]}),Object(ve.jsx)(ja,{}),Object(ve.jsxs)("div",{className:"page-content",children:[Object(ve.jsx)("div",{className:"page-content-actions",children:Object(ve.jsx)(ca,{showAddFolder:!this.props.showAll&&!this.props.showMine&&!this.props.showShared,folder:this.props.folder})}),Object(ve.jsx)("div",{className:"secret-list-content-table-header",children:Object(ve.jsxs)("div",{children:[Object(ve.jsx)("div",{className:"secret-list-item-column--title",children:Object(ve.jsx)(be.a,{id:"Title"})}),Object(ve.jsx)("div",{className:"secret-list-item-column--last-modified",children:Object(ve.jsx)(be.a,{id:"Last modified"})}),Object(ve.jsx)("div",{className:"secret-list-item-column--shared-with",children:Object(ve.jsx)(be.a,{id:"Shared with"})}),Object(ve.jsx)("div",{className:"secret-list-item-column--actions"})]})}),Object(ve.jsx)(sa,{filtered:r,secrets:this.props.secrets,folders:this.props.folders,isDragging:this.props.isDragging,searchQuery:this.state.searchQuery,endDecrypt:null===this.props.status})]})]})}}]),n}(l.Component);fa.defaultProps={folders:[],secrets:{},searchQuery:"",showAll:!1,showMine:!1,showShared:!1};var ma=new pr.DragDropContext(hr.a)(Object(pr.DragLayer)((function(e){return{isDragging:e.isDragging()}}))(fa)),ga=Object(cr.a)((function(e){return e.path?e.path.split("/"):[]}),(function(e,t){return dr()(e,t)}));function Oa(e){var t=e.match.params,n=e.showAll,r=e.showMine,s=e.showShared,a=Object(g.d)((function(e){return e.Metadata.metadata})),i=Object(g.d)(ce),o=Object(g.d)(le),c=Object(g.d)(ue),l=ga(t),d=l[l.length-1],u=Object(g.d)((function(e){return de(e,d)}));if(n)return Object(ve.jsx)(ma,{secrets:i,showAll:!0});if(r)return Object(ve.jsx)(ma,{secrets:o,showMine:!0});if(s)return Object(ve.jsx)(ma,{secrets:c,showShared:!0});var h=a.find((function(e){return e.id===d}));return Object(ve.jsx)(ma,{folder:h,folders:l,secrets:u})}Oa.defaultProps={showAll:!1,showMine:!1,showShared:!1};var va=Oa,ya=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(j.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(j.a)(r)),r.state={shortpass:""},r}return Object(b.a)(n,[{key:"handleChange",value:function(e){var t=e.name,n=e.value;this.setState(Object(Oe.a)({},t,n))}},{key:"handleSubmit",value:function(){this.props.actions.activateShortLogin({shortpass:this.state.shortpass})}},{key:"render",value:function(){return Object(ve.jsxs)(Ce,{show:this.props.shown,onClose:this.props.actions.hideShortLogin,children:[Object(ve.jsx)(Ce.Header,{children:Object(ve.jsx)("span",{className:"text",children:"Trust this device"})}),Object(ve.jsx)(Ce.Body,{children:Object(ve.jsx)(Ge,{className:"totp-form",id:"totp",onSubmit:this.handleSubmit,children:Object(ve.jsx)(Ke,{label:"Shortpass",name:"shortpass",value:this.state.shortpass,type:"password",onChange:this.handleChange,autoFocus:!0})})}),Object(ve.jsxs)(Ce.Footer,{children:[Object(ve.jsx)(Ue,{type:"reset",buttonStyle:"default",onClick:this.props.actions.hideShortLogin,children:"Close"}),Object(ve.jsx)(Ue,{type:"button",buttonStyle:"primary",onClick:this.handleSubmit,disabled:this.props.loading,children:"Activate"})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e){return e.shown?null:{shortpass:""}}}]),n}(l.Component);ya.defaultProps={shown:!1,errors:{},loading:!1};var wa=Object(g.b)((function(e){var t=e.Options;return{errors:t.errors,shown:t.showShortLogin,loading:t.loading}}),(function(e){return{actions:Object(ht.bindActionCreators)(o,e)}}))(ya),xa=n(236),Sa=n.n(xa),Ca=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(j.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(j.a)(r)),r.state={seed:w.a.Utils.generateSeed(),token:""},r}return Object(b.a)(n,[{key:"handleChange",value:function(e){var t=e.value.replace(/\s+/g,"").slice(0,6);this.setState({token:t})}},{key:"handleSubmit",value:function(){this.props.actions.activateTotp(this.state)}},{key:"render",value:function(){return Object(ve.jsxs)(Ce,{show:this.props.shown,onClose:this.props.actions.hideQRCode,children:[Object(ve.jsx)(Ce.Header,{children:Object(ve.jsx)("span",{className:"text",children:"Activate Two-Factor authentication"})}),Object(ve.jsx)(Ce.Body,{children:Object(ve.jsxs)(Ge,{className:"totp-form",id:"totp",onSubmit:this.handleSubmit,children:[Object(ve.jsx)("div",{className:"totp-form-qrcode",children:Object(ve.jsx)(Sa.a,{className:"totp-form-qrcode",value:"otpauth://totp/Secret-in.me?secret=".concat(this.state.seed.b32),size:256})}),Object(ve.jsx)(Ke,{name:"token",inputProps:{maxLength:6},placeholder:"6-digit code",value:this.state.token,onChange:this.handleChange,onSubmit:this.handleSubmit,error:this.props.errors.totp,autoFocus:!0})]})}),Object(ve.jsxs)(Ce.Footer,{children:[Object(ve.jsx)(Ue,{type:"reset",buttonStyle:"default",onClick:this.props.actions.hideQRCode,children:"Close"}),Object(ve.jsx)(Ue,{type:"button",buttonStyle:"primary",onClick:this.handleSubmit,disabled:this.props.loading,children:"Activate"})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e){return e.shown?null:{seed:w.a.Utils.generateSeed(),token:""}}}]),n}(l.Component);Ca.defaultProps={shown:!1,errors:{},loading:!1};var ka=Object(g.b)((function(e){var t=e.Options;return{errors:t.errors,shown:t.showQRCode,loading:t.loading}}),(function(e){return{actions:Object(ht.bindActionCreators)(o,e)}}))(Ca);function Ua(e){var t=e.username,n=e.rescueCodes.map((function(e,t){return"".concat(t+1,". ").concat(e)})),r=["SAVE YOUR BACKUP CODES","Keep these backup codes somewhere safe but accessible.",""].concat(Object(br.a)(n),["","* Codes for user ".concat(t),"* Generated on ".concat(tt()().format("MMM Do, YYYY")),"* You can only use each backup code once.","* Need new codes? Go to ".concat(document.location.href)]).join("\n");return new Blob([r],{type:"text/plain;charset=utf-8;"})}var Na=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).currentUser=e.currentUser,r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props.rescueCodes,t=this.currentUser.username;return Object(ve.jsxs)(Ce,{show:this.props.shown,onClose:this.props.actions.hideRescueCodes,children:[Object(ve.jsx)(Ce.Header,{children:Object(ve.jsx)("span",{className:"text",children:"Rescue codes"})}),Object(ve.jsxs)(Ce.Body,{children:[Object(ve.jsx)("h3",{children:"You should view and download your recovery codes and keep them safe."}),Object(ve.jsx)("p",{children:"If you lose access to your secure token and your code generator, a recovery code is the only way to recover your account."}),Object(ve.jsx)("pre",{children:e.join(" ")}),Object(ve.jsx)("p",{children:Object(ve.jsx)("a",{href:window.URL.createObjectURL(Ua({username:t,rescueCodes:e})),download:"Backup-codes-".concat(t,"@secretin.txt"),children:"Download my codes"})})]}),Object(ve.jsx)(Ce.Footer,{children:Object(ve.jsx)(Ue,{type:"reset",buttonStyle:"default",onClick:this.props.actions.hideRescueCodes,children:"Close"})})]})}}]),n}(l.Component);Na.defaultProps={shown:!1,rescueCodes:[]};var Fa=Object(g.b)((function(e){var t=e.Options;return{rescueCodes:t.rescueCodes,shown:t.showRescueCodes,currentUser:e.AppUI.currentUser}}),(function(e){return{actions:Object(ht.bindActionCreators)(o,e)}}))(Na),Ta=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleChangePassword=r.handleChangePassword.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"handleChangePassword",value:function(){this.props.dispatch(is({newPass:this.props.newPass1}))}},{key:"render",value:function(){var e=this;return Object(ve.jsxs)(Ce,{show:this.props.shown,onClose:function(){return e.props.dispatch(Jr())},children:[Object(ve.jsx)(Ce.Header,{children:Object(ve.jsx)("span",{className:"text",children:"Change master password"})}),"success"!==this.props.status?Object(ve.jsxs)(Ce.Body,{children:[Object(ve.jsx)(Ke,{name:"newPass1",label:"New password",value:this.props.newPass1,onChange:function(){return e.props.dispatch(Qr.apply(o,arguments))},type:"password",disabled:this.props.loading}),this.props.newPass1.length>0&&Object(ve.jsx)("span",{className:"options-changepassword",children:Object(ve.jsx)(Ke,{name:"newPass2",label:"Retype",value:this.props.newPass2,onChange:function(){return e.props.dispatch(qr.apply(o,arguments))},type:"password",disabled:this.props.loading})}),Object(ve.jsxs)("div",{className:"options-changepassword-infos",children:[""===this.props.error&&this.props.newPass1.length>0&&this.props.newPass1!==this.props.newPass2&&"Passwords mismatch",""!==this.props.error&&this.props.error]})]}):Object(ve.jsx)(Ce.Body,{children:Object(ve.jsx)("div",{className:"options-changepassword-success",children:"Success"})}),Object(ve.jsxs)(Ce.Footer,{children:[Object(ve.jsx)(Ue,{type:"reset",buttonStyle:"default",onClick:function(){return e.props.dispatch(Jr())},children:"Close"}),this.props.newPass1.length>0&&Object(ve.jsx)(Ue,{type:"button",buttonStyle:"primary",onClick:this.handleChangePassword,disabled:this.props.newPass1!==this.props.newPass2,children:"Change it"})]})]})}}]),n}(l.Component);Ta.defaultProps={shown:!1,loading:!1,newPass1:"",newPass2:"",error:""};var Pa=Object(g.b)((function(e){var t=e.Options.newPass;return{error:t.error,shown:t.shown,loading:t.loading,status:t.status,newPass1:t.newPass1,newPass2:t.newPass2}}))(Ta),Aa=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onChange=r.onChange.bind(Object(j.a)(r)),r.id=Object(Re.uniqueId)("input_"),r}return Object(b.a)(n,[{key:"onChange",value:function(e){this.props.onChange({name:this.props.name,checked:e.target.checked})}},{key:"render",value:function(){var e=ge()("checkbox",{"checkbox--checked":this.props.checked,"checkbox--unchecked":!this.props.checked});return Object(ve.jsxs)("div",{className:"input input--type-checkbox",children:[Object(ve.jsx)("input",{id:this.id,type:"checkbox",name:this.props.name,checked:this.props.checked,disabled:this.props.disabled,onChange:this.onChange}),Object(ve.jsxs)("label",{htmlFor:this.id,children:[Object(ve.jsx)("div",{className:e}),this.props.children]})]})}}]),n}(l.Component);Aa.defaultProps={checked:!1,disabled:!1};var Ia=Aa,La=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).onChangeTimeToClose=r.onChangeTimeToClose.bind(Object(j.a)(r)),r.onChangeDefaultUsername=r.onChangeDefaultUsername.bind(Object(j.a)(r)),r.onSaveDefaultUsername=r.onSaveDefaultUsername.bind(Object(j.a)(r)),r.state={defaultUsername:e.options.defaultUsername},r}return Object(b.a)(n,[{key:"onChangeDefaultUsername",value:function(e){var t=e.value;this.setState({defaultUsername:t})}},{key:"onChangeTimeToClose",value:function(e){var t=e.value;this.props.actions.changeTimeToClose({timeToClose:""===t?-1:parseInt(t,10)||0})}},{key:"onSaveDefaultUsername",value:function(){this.props.actions.changeDefaultUsername({defaultUsername:this.state.defaultUsername})}},{key:"render",value:function(){var e=this.props,t=e.options,n=e.isOnline,r=e.options.defaultUsername,s=void 0===r?"":r;return Object(ve.jsxs)("div",{className:"page",children:[Object(ve.jsx)("div",{className:"page-header",children:Object(ve.jsx)("div",{className:"breadcrumb",children:Object(ve.jsx)(Zs,{link:"/options/",icon:"gear",title:"Options"})})}),Object(ve.jsxs)("div",{className:"page-content options",children:[Object(ve.jsxs)("div",{className:"options-section",children:[Object(ve.jsx)("h3",{className:"options-section-title",children:"Experience"}),Object(ve.jsxs)("div",{className:"options-section-item",children:[Object(ve.jsx)(Ke,{name:"defaultUsername",label:"Default username",size:"small",value:this.state.defaultUsername,onChange:this.onChangeDefaultUsername,disabled:!n}),Object(ve.jsx)("div",{className:"options-section-subitem-save",children:Object(ve.jsx)(Ue,{type:"button",buttonStyle:this.state.defaultUsername===s?"default":"primary",onClick:this.onSaveDefaultUsername,size:"small",disabled:!n||this.state.defaultUsername===s,children:"Save"})})]})]}),Object(ve.jsxs)("div",{className:"options-section",children:[Object(ve.jsx)("h3",{className:"options-section-title",children:"Security"}),Object(ve.jsxs)("div",{className:"options-section-item",children:[Object(ve.jsx)(ka,{}),Object(ve.jsx)(Ia,{checked:t.totp,onChange:this.props.actions.toggleTotp,disabled:!n,children:"Activate two-factor authentication"}),t.totp&&Object(ve.jsxs)("div",{className:"options-section-subitem",children:[Object(ve.jsx)(Fa,{}),Object(ve.jsx)(Ue,{size:"small",buttonStyle:"default",onClick:this.props.actions.showRescueCodes,children:"Generate rescue Codes"})]})]}),Object(ve.jsxs)("div",{className:"options-section-item",children:[Object(ve.jsx)(wa,{}),Object(ve.jsx)(Ia,{checked:t.shortLogin,onChange:this.props.actions.toggleShortLogin,disabled:!n,children:"Activate ShortLogin"})]}),Object(ve.jsxs)("div",{className:"options-section-item",children:[Object(ve.jsx)(Ia,{checked:0!==t.timeToClose,onChange:this.props.actions.toggleAutoLogout,disabled:!n,children:"Activate auto logout"}),(-1===t.timeToClose||t.timeToClose>0)&&Object(ve.jsxs)("div",{className:"options-section-subitem",children:["Disconnect me after ",Object(ve.jsx)(Ke,{name:"timeToClose",label:"",size:"small",value:-1===t.timeToClose?"":t.timeToClose.toString(),onChange:this.onChangeTimeToClose,type:"number",inputProps:{min:0,max:60,step:5},disabled:!n}),Object(ve.jsx)("b",{children:" min"})]})]})]}),Object(ve.jsx)("div",{className:"options-section",children:Object(ve.jsxs)("div",{className:"options-section-item",children:[Object(ve.jsx)(Pa,{}),Object(ve.jsx)(Ue,{type:"button",buttonStyle:"warning",onClick:this.props.actions.showChangePassword,disabled:!n,children:"Change master password"})]})})]})]})}}]),n}(l.Component),Ma=Object(g.b)((function(e){return{options:e.Options.options,isOnline:e.AppUI.online}}),(function(e){return{actions:Object(ht.bindActionCreators)(o,e)}}))(La);var Ra=function(){return Object(ve.jsx)("div",{className:"spinner",children:Object(ve.jsx)("svg",{className:"spinner-svg",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg",children:Object(ve.jsx)("circle",{className:"spinner-svg-path",fill:"none",strokeWidth:"3",strokeLinecap:"round",cx:"33",cy:"33",r:"30"})})})},Da=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleFileInputChange=r.handleFileInputChange.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"handleFileInputChange",value:function(e){this.props.onFileChoosen(e.target.files[0])}},{key:"render",value:function(){return this.props.connectDropTarget(Object(ve.jsxs)("div",{className:"import-drop-zone",children:[Object(ve.jsx)(xe,{id:"upload",size:120}),Object(ve.jsxs)("div",{className:"import-drop-zone-label",children:[Object(ve.jsx)("input",{id:"import-drop-zone-input",className:"import-drop-zone-input",type:"file",onChange:this.handleFileInputChange}),Object(ve.jsx)("label",{htmlFor:"import-drop-zone-input",children:"Choose a file"}),Object(ve.jsx)("span",{children:" or drag it here."})]})]}))}}]),n}(l.Component);var Ea=new pr.DropTarget(ur.NativeTypes.FILE,{drop:function(e,t){e.onFileChoosen(t.getItem().files[0])}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))(Da),za=new pr.DragDropContext(hr.a)(Ea),Ba=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"handleChange",value:function(e){var t=e.value,n={field:this.props.field,value:t};this.props.onChange(n)}},{key:"render",value:function(){var e=this;return Object(ve.jsx)(Ke,{ref:function(t){e.input=t},label:this.props.field.name,name:this.props.field.name,value:this.props.field.value,onChange:this.handleChange,type:this.props.field.type})}}]),n}(l.Component),_a=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=Object.keys(this.props.mandatoryFields),n=[];return t.forEach((function(t){n.push(Object(ve.jsx)(Ba,{field:e.props.mandatoryFields[t],onChange:e.props.actions.changeMandatoryField},t))})),Object(ve.jsx)("div",{children:n})}}]),n}(l.Component),Ga=Object(g.b)((function(e){return{mandatoryFields:e.Import.mandatoryFields}}),(function(e){return{actions:Object(ht.bindActionCreators)(c,e)}}))(_a),Ha=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).handleFileChoosen=r.handleFileChoosen.bind(Object(j.a)(r)),r.handleStartParsing=r.handleStartParsing.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"handleFileChoosen",value:function(e){this.props.importActions.detectType({file:e})}},{key:"handleStartParsing",value:function(){this.props.importActions.importSecrets({file:this.props.file,mandatoryFields:this.props.mandatoryFields,type:this.props.importType})}},{key:"shouldComponentUpdate",value:function(e,t){return!0!==this.props.success||e.success!==this.props.success}},{key:"componentDidUpdate",value:function(){var e=this;this.props.success&&(this.props.metadataActions.loadMetadata(),setTimeout((function(){e.props.importActions.defaultStore()}),1500))}},{key:"render",value:function(){return Object(ve.jsxs)("div",{className:"page",children:[Object(ve.jsx)("div",{className:"page-header",children:Object(ve.jsx)("div",{className:"breadcrumb",children:Object(ve.jsx)(Zs,{link:"/import/",icon:"import",title:"Import"})})}),Object(ve.jsxs)("div",{className:"page-content options",children:[Object(ve.jsxs)("span",{children:["Supported type are ",Object(ve.jsx)("i",{children:"secret-in"}),", ",Object(ve.jsx)("i",{children:"keepass"})]}),(this.props.success||this.props.importing)&&(this.props.success&&Object(ve.jsxs)("div",{className:"import-progress",children:[Object(ve.jsx)(xe,{id:"done",size:120}),Object(ve.jsx)("div",{className:"import-progress-title",children:"Done!"})]})||Object(ve.jsxs)("div",{className:"import-progress",children:[Object(ve.jsx)(Ra,{}),0!==this.props.importTotal&&Object(ve.jsx)("div",{className:"import-progress-title",children:"Importing... ".concat(this.props.importStatus," / ").concat(this.props.importTotal)})]}))||Object(ve.jsx)(za,{onFileChoosen:this.handleFileChoosen}),""!==this.props.error&&Object(ve.jsx)("span",{children:this.props.error.message}),Object.keys(this.props.mandatoryFields).length>0&&Object(ve.jsx)(Ga,{mandatoryFields:this.props.mandatoryFields}),""!==this.props.importType&&Object(ve.jsxs)(Ue,{buttonStyle:"primary",className:"button button--style-default button--size-base",onClick:this.handleStartParsing,children:["Import from ",this.props.importType]})]})]})}}]),n}(l.Component),Ya=Object(g.b)((function(e){var t=e.Import;return{error:t.error,importType:t.importType,importing:t.importing,importStatus:t.importStatus,importTotal:t.importTotal,success:t.success,file:t.file,mandatoryFields:t.mandatoryFields}}),(function(e){return{importActions:Object(ht.bindActionCreators)(c,e),metadataActions:Object(ht.bindActionCreators)(r,e)}}))(Ha);var Va=function(){return Object(ve.jsxs)("div",{className:"layout",children:[Object(ve.jsx)(or,{}),Object(ve.jsx)(ut,{}),Object(ve.jsx)("div",{className:"layout-pane",children:Object(ve.jsxs)(it.d,{children:[Object(ve.jsx)(it.b,{path:"/secrets/all",render:function(e){return Object(ve.jsx)(va,Object(v.a)(Object(v.a)({},e),{},{showAll:!0}))}}),Object(ve.jsx)(it.b,{path:"/secrets/mine",render:function(e){return Object(ve.jsx)(va,Object(v.a)(Object(v.a)({},e),{},{showMine:!0}))}}),Object(ve.jsx)(it.b,{path:"/secrets/shared",render:function(e){return Object(ve.jsx)(va,Object(v.a)(Object(v.a)({},e),{},{showShared:!0}))}}),Object(ve.jsx)(it.b,{path:"/secrets/:path*",render:function(e){return Object(ve.jsx)(va,Object(v.a)({},e))}}),Object(ve.jsx)(it.b,{path:"/settings/",component:Ma}),Object(ve.jsx)(it.b,{path:"/import/",component:Ya}),Object(ve.jsx)(it.a,{to:"/secrets/"})]})})]})},Wa=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).disconnectingEvent=null,r.onAppFocus=r.onAppFocus.bind(Object(j.a)(r)),r.onAppBlur=r.onAppBlur.bind(Object(j.a)(r)),r.handleConnectionChange=r.handleConnectionChange.bind(Object(j.a)(r)),window.addEventListener("focus",r.onAppFocus),window.addEventListener("blur",r.onAppBlur),r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){F.addEventListener("connectionChange",this.handleConnectionChange)}},{key:"componentWillUnmount",value:function(){F.removeEventListener("connectionChange",this.handleConnectionChange)}},{key:"handleConnectionChange",value:function(e){var t=e.connection;this.props.dispatch(Q(t))}},{key:"onAppFocus",value:function(){clearTimeout(this.disconnectingEvent)}},{key:"onAppBlur",value:function(){clearTimeout(this.disconnectingEvent);var e=this.props,t=e.connected,n=e.options;if(t&&n&&n.timeToClose>0){var r=60*n.timeToClose*1e3;this.disconnectingEvent=setTimeout((function(){return window.location.reload()}),r)}}},{key:"render",value:function(){var e=this;return Or(),Object(ve.jsx)(mr.b,{locale:gr(),defaultLocale:gr(),messages:Ae(gr()),children:Object(ve.jsx)(O.a,{basename:"",children:Object(ve.jsxs)("div",{className:"App",children:[this.props.connected?Object(ve.jsx)(Va,{}):Object(ve.jsx)(at,{savedUsername:this.props.savedUsername,loading:this.props.loading,errors:this.props.errors}),Object(ve.jsx)(Be,{onChangeLanguage:function(){return e.forceUpdate()}})]})})})}}]),n}(l.Component),Qa=Object(g.b)((function(e){var t=e.AppUI;return{savedUsername:t.savedUsername,loading:t.loading,errors:t.errors,connected:t.connected,secrets:de(e),options:e.Options.options}}))(Wa);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(484);var qa=document.getElementById("root");h.a.render(Object(ve.jsx)(g.a,{store:zs,children:Object(ve.jsx)(Qa,{})}),qa),"undefined"===typeof window.process&&"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[485,1,2]]]);
//# sourceMappingURL=main.7f787b57.chunk.js.map